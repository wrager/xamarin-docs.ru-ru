---
title: Обновление существующего приложений iOS
description: Выполните следующие действия для обновления существующего приложения Xamarin.iOS для использования в единой API.
ms.prod: xamarin
ms.assetid: 303C36A8-CBF4-48C0-9412-387E95024CAB
ms.technology: xamarin-cross-platform
author: asb3993
ms.author: amburns
ms.date: 03/29/2017
ms.openlocfilehash: ce7e269f76567f824c4cc65916bed32f0f6c08d1
ms.sourcegitcommit: 945df041e2180cb20af08b83cc703ecd1aedc6b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/04/2018
---
# <a name="updating-existing-ios-apps"></a>Обновление существующего приложений iOS

_Выполните следующие действия для обновления существующего приложения Xamarin.iOS для использования в единой API._

Обновление существующего приложения для использования API единой требует внесения изменений в самом файле проекта также относительно пространства имен и API, используемые в коде приложения.

## <a name="the-road-to-64-bits"></a>Пути к 64-разрядная

Новые API единой необходимы для поддержки 64-разрядных архитектур устройств из мобильного приложения Xamarin.iOS. Начиная с 1 февраля 2015 г. Apple требует, чтобы все новые отправки приложений в магазине приложений iTunes поддерживает 64-разрядной архитектуры.

Xamarin предоставляет средства для Visual Studio для Mac и Visual Studio для автоматизации процесса миграции с классической API в единой API или файлов проекта можно преобразовать вручную. Хотя настоятельно рекомендуется с помощью автоматического средства, в этой статье будут рассмотрены оба метода.

### <a name="before-you-start"></a>Перед началом работы...

Перед обновлением существующего кода в единой API, настоятельно рекомендуется устранить все *предупреждения компиляции*. Многие *предупреждения* в классический API станет как ошибки, после перехода на единый. Исправления перед началом выполняется проще, поскольку сообщения компилятора из классический API часто содержат указания о том, что для обновления.

## <a name="automated-updating"></a>Автоматическое обновление

После устранения предупреждения, выберите существующий проект iOS в Visual Studio для Mac или Visual Studio и выберите **Миграция в единой API Xamarin.iOS** из **проекта** меню. Пример:

![](updating-ios-apps-images/beta-tool1.png "Выбрать миграции Xamarin.iOS единой API из меню "проект"")

Необходимо дать согласие на это предупреждение, перед запуском автоматической миграции (очевидно, что вам следует иметь резервные копии и системы управления версиями перед переходом на этом adventure):

![](updating-ios-apps-images/beta-tool2.png "Согласиться на это предупреждение перед запуском автоматической миграции")

По сути, средство автоматизирует все шаги, описанные в **обновление вручную** раздел представленные ниже и является предложенным методом преобразования существующего проекта Xamarin.iOS в единой API.

## <a name="steps-to-update-manually"></a>Действия для обновления вручную

Еще раз после устранения предупреждения выполните следующие действия для обновления приложения Xamarin.iOS для использования нового API единой вручную.

### <a name="1-update-project-type--build-target"></a>1. Тип обновления проекта и целевой объект построения

Изменить версию проекта в вашей **csproj** файлов из `6BC8ED88-2882-458C-8E55-DFD12B67127B` для `FEACFBD2-3405-455C-9665-78FE426C6842`. Изменить **csproj** файл в текстовом редакторе, заменив первый элемент в `<ProjectTypeGuids>` элемента, как показано:

![](updating-ios-apps-images/csproj.png "Измените csproj-файле в текстовом редакторе, заменив первый элемент в элемент ProjectTypeGuids, как показано")

Изменение **импорта** элемент, содержащий `Xamarin.MonoTouch.CSharp.targets` для `Xamarin.iOS.CSharp.targets` следующим:

![](updating-ios-apps-images/csproj2.png "Изменить элемент Import, содержащий Xamarin.MonoTouch.CSharp.targets для Xamarin.iOS.CSharp.targets, как показано")

### <a name="2-update-project-references"></a>2. Обновление ссылок проекта

Разверните проект приложения iOS **ссылки** узла. Первоначально будут отображены * неработающие - **monotouch** ссылки как на следующий снимок экрана (так как мы только что изменили тип проекта):

![](updating-ios-apps-images/references.png "Он первоначально будут отображены ссылку неработающие monotouch похоже на этот снимок экрана из-за изменения типа проекта")

Щелкните правой кнопкой мыши проект приложения iOS для **изменить ссылки**, выберите команду **monotouch** ссылки и удалить с помощью кнопки «X» красного цвета.

![](updating-ios-apps-images/references-delete-monotouch-sml.png "Правой кнопкой мыши проект приложения iOS, чтобы изменить ссылки, затем щелкните ссылку на библиотеку monotouch и удалить его с помощью красный значок X кнопки")

Прокрутите в конец списка ссылок и делений **Xamarin.iOS** сборки.

![](updating-ios-apps-images/references-add-xamarinios-sml.png "Прокрутите в конец списка ссылок и делений Xamarin.iOS сборки")

Нажмите клавишу **ОК** сохранить ссылки на проект.

### <a name="3-remove-monotouch-from-namespaces"></a>3. Удалите MonoTouch из пространства имен

Удалить **MonoTouch** префикс из пространства имен в `using` инструкции или везде, где classname полностью квалифицирован (например) `MonoTouch.UIKit` становится просто `UIKit`).

### <a name="4-remap-types"></a>4. Сопоставление типов

[Собственные типы](~/cross-platform/macios/nativetypes.md) была введена которой заменить некоторые типы, которые ранее были использованы, такие как экземпляры компонента `System.Drawing.RectangleF` с `CoreGraphics.CGRect` (например). Полный список типов можно найти на [собственные типы](~/cross-platform/macios/nativetypes.md) страницы.

### <a name="5-fix-method-overrides"></a>5. Исправьте переопределения методов

Некоторые `UIKit` методы были изменены для использования новой подписи [собственные типы](~/cross-platform/macios/nativetypes.md) (такие как `nint`). Если пользовательские подклассов переопределить эти методы сигнатурами больше не будет соответствовать и приведет к ошибкам. Исправьте эти переопределения методов, изменив подкласс для сопоставления нового подпись, используя собственные типы.

Примеры включают изменение `public override int NumberOfSections (UITableView tableView)` для возврата `nint` и изменив обе функции возвращают тип и типы параметров в `public override int RowsInSection (UITableView tableView, int section)` для `nint`.

## <a name="considerations"></a>Особенности

Следующие факторы следует принимать во внимание при преобразовании существующего проекта Xamarin.iOS классический API в новый интерфейс API единой Если приложение зависит от компонента или пакета NuGet.

### <a name="components"></a>Компоненты

Любой компонент, который включен в приложении также необходимо обновить в единой API или при компиляции возникнет конфликт. Для любого компонента включено заменить текущую версию с новой версией в магазине Xamarin компонента, поддерживающий API единой и выполните чистую сборку. Любой компонент, который еще не был преобразован автором, будут отображаться только предупреждение в хранилище компонентов 32-разрядная.

### <a name="nuget-support"></a>Поддержка NuGet

Пока мы публиковать изменения NuGet для работы с поддержкой единого API, не нового выпуска NuGet, поэтому мы оценке способы получения NuGet распознавать новые интерфейсы API.

До этого времени, так же, как компоненты необходимо для переключения любой пакет NuGet, включенных в версию, которая поддерживает API-интерфейсы единого проект и затем выполните чистую сборку.

> [!IMPORTANT]
> При наличии ошибки в виде _«ошибка 3 не может включать в том же проекте Xamarin.iOS «monotouch.dll» и «Xamarin.iOS.dll» — «Xamarin.iOS.dll» упоминается явно, пока ссылается «monotouch.dll» "xxx, версия = 0.0.000, Язык и региональные параметры = neutral, PublicKeyToken = null'»_ после преобразования приложения единой API-интерфейсам, это обычно из-за наличия компонента или пакета NuGet в проект, который не был обновлен для API единой. Необходимо удалить существующий компонент/NuGet, обновите версию, которая поддерживает API-интерфейсы единой и выполните чистую сборку.

## <a name="enabling-64-bit-builds-of-xamarinios-apps"></a>Включение 64-разрядных сборок приложения Xamarin.iOS

Для мобильного приложения Xamarin.iOS, преобразованное в единой API разработчику по-прежнему необходимо позволяют строить приложения для 64-разрядных компьютерах из параметров приложения. См. в разделе **Включение 64 разрядных сборок из Xamarin.iOS приложений** из [анализ 32 или 64-разрядной платформе](~/cross-platform/macios/32-and-64/index.md#enable-64) документа подробные инструкции по включению 64-разрядных сборок.

## <a name="finishing-up"></a>Завершающие операции

Ли вы решили использовать автоматический или ручной метод для преобразования приложения Xamarin.iOS из классической единой API-интерфейсам, существует несколько экземпляров, кроме того, требующих ручного вмешательства. См. в разделе нашей [советы для обновления кода в единой API](~/cross-platform/macios/unified/updating-tips.md) документов для известных проблем и обходных пути.

## <a name="related-links"></a>Связанные ссылки

- [Советы по обновлению кода в Unified API](~/cross-platform/macios/unified/updating-tips.md)
- [Работа с собственными типами в кроссплатформенных приложениях](~/cross-platform/macios/native-types-cross-platform.md)
- [Классический vs отличия единой API](https://developer.xamarin.com/releases/ios/api_changes/classic-vs-unified-8.6.0/)
- [Переход на API единой (видео)](http://university.xamarin.com/lightninglectures/migrating-to-the-unified-api)
