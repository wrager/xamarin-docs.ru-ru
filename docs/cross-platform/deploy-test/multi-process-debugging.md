---
title: Отладка нескольких процессов
ms.prod: xamarin
ms.assetid: 852F8AB1-F9E2-4126-9C8A-12500315C599
author: asb3993
ms.author: amburns
ms.date: 03/24/2017
ms.openlocfilehash: c1f2781477c04e79ad190f0067d685af1c0a4119
ms.sourcegitcommit: 0a72c7dea020b965378b6314f558bf5360dbd066
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/09/2018
---
# <a name="multi-process-debugging"></a>Отладка нескольких процессов

Обычно современные решения, разработанные в Visual Studio для Mac, содержат несколько проектов, предназначенных для разных платформ. Например, решение может содержать проект мобильного приложения, основанный на данных из проекта веб-службы. При разработке такого решения может потребоваться запустить оба проекта одновременно для устранения неполадок. Начиная с [выпуска Xamarin Cycle 9](https://releases.xamarin.com/stable-release-cycle-9/), в Visual Studio для Mac можно отлаживать несколько параллельно выполняющихся процессов. Это позволяет задавать точки останова, проверять значения переменных и просматривать потоки в нескольких работающих проектах. Такая ситуация называется _отладкой нескольких процессов_. 

В этом руководстве будут рассматриваться некоторые изменения, внесенные в Visual Studio для Mac для поддержки отладки нескольких процессов, описываться настройка решений для отладки нескольких процессов и приводиться сведения о присоединении к существующим процессам с помощью Visual Studio для Mac.

## <a name="requirements"></a>Требования

Для отладки нескольких процессов требуется Visual Studio для Mac.

## <a name="ide-changes"></a>Изменения в интегрированной среде разработки

В целях упрощения процедуры отладки нескольких процессов в пользовательский интерфейс в Visual Studio для Mac был внесен ряд изменений. В Visual Studio для Mac обновлена **панель инструментов "Отладка"** и добавлен новый раздел **Конфигурация решений** в папку **Параметры решений**. Кроме того, теперь на **панели "Потоки"** будут отображаться выполняющиеся процессы и потоки для каждого процесса. В Visual Studio для Mac также будет выводиться несколько панелей отладки (по одной для каждого процесса) для определенных целей, например **Выходные данные приложения**.

### <a name="solution-configurations"></a>Конфигурации решения

По умолчанию отдельный проект в Visual Studio для Mac будет отображаться в области **Конфигурации решения** панели инструментов отладки. При запуске сеанса отладки Visual Studio для Mac откроет этот проект и присоединит к нему отладчик.

Для запуска и отладки нескольких процессов в Visual Studio для Mac необходимо создать _конфигурацию решения_. Конфигурация решения описывает, какие проекты в решении должны быть включены при запуске сеанса отладки с помощью кнопки **Начать** или сочетания клавиш &#8984;&#8617 (**Cmd+ВВОД**). Следующий снимок экрана является примером решения в Visual Studio для Mac с несколькими конфигурациями решения:

![](multi-process-debugging-images/mpd01-xs.png "Решение с несколькими конфигурациями")

### <a name="parts-of-the-debug-toolbar"></a>Части панели инструментов "Отладка"

Чтобы конфигурацию решения можно было выбирать с помощью всплывающего меню, были внесены изменения в панель инструментов "Отладка". На этом снимке экрана показаны части панели инструментов "Отладка":

![](multi-process-debugging-images/mpd02-xs.png "Части панели инструментов "Отладка"")

1. **Конфигурация решения.** Можно задать конфигурацию решения, щелкнув конфигурацию в разделе "Решение" на панели инструментов отладки и выбрав нужный вариант во всплывающем меню:

    ![](multi-process-debugging-images/mpd03-xs.png "Пример всплывающего меню с конфигурациями решения")

2. **Целевой объект сборки.** Определяет целевой объект сборки для проектов. Не изменился по сравнению с предыдущими версиями Visual Studio для Mac.
3. **Целевые устройства.** Выбирает устройства, на которых будет выполняться решение. Для каждого проекта можно определить отдельное устройство или эмулятор:

    ![](multi-process-debugging-images/mpd04-xs.png "Всплывающее окно с отображением устройств для проекта")

### <a name="multiple-debug-pads"></a>Несколько панелей отладки

При запуске конфигурации с несколькими решениями некоторые панели Visual Studio для Mac будут отображены несколько раз, по одной для каждого процесса. Например, на следующем снимке экрана показаны две панели **Выходные данные приложения** для решения, в котором выполняются два проекта:

![](multi-process-debugging-images/mpd05-xs.png "Панель выходных данных для конфигурации решения")

### <a name="multiple-processes-and-the-active-thread"></a>Несколько процессов и _активный поток_

Если один процесс достигает точки останова, его выполнение приостанавливается, тогда как другие процессы продолжают работать. В сценарии с одним процессом Visual Studio для Mac может с легкостью отображать в одном наборе панелей такие сведения, как потоки, локальные переменные, выходные данные приложения. Однако при наличии нескольких процессов с несколькими точками останова и, возможно, с несколькими потоками разработчик может не справиться с данными из сеанса отладки, который пытается отобразить сразу все сведения из всех потоков (и процессов).

Чтобы устранить эту проблему, Visual Studio для Mac будет выводить информацию только из одного потока за один раз. Это называется использованием _активного потока_. _Активным потоком_ считается первый поток, который приостанавливается в точке останова. Активный поток — это поток, который находится в фокусе внимания разработчика. В активном потоке будут выполняться такие команды отладки, как **Шаг с обходом** &#8679;&#8984;O (SHIFT+Cmd+O).

На **панели "Поток"** отображаются сведения для всех процессов и потоков, которые просматриваются в конфигурации решения, и приводятся визуальные подсказки о том, что является активным потоком:

![](multi-process-debugging-images/mpd06-xs.png "Панель "Поток" для конфигурации решения")

Потоки группируются по процессу, в котором они размещаются. Имя проекта и идентификатор активного потока будут отображаться полужирным шрифтом, а в области рядом с активным потоком появится стрелка вправо. На предыдущем снимке экрана активным потоком является **поток № 1** в **процессе с ИД 48703** (**FirstProject**).

При отладке нескольких процессов можно воспользоваться **панелью "Поток"**, чтобы переключить активный поток и увидеть отладочную информацию по этому процессу (или потоку). Для переключения активного потока выберите нужный поток на **панели "Поток"**, а затем дважды щелкните его.

#### <a name="stepping-through-code-when-multiple-projects-are-stopped"></a>Пошаговая отладка кода при остановке нескольких проектов

Если два (или более) проекта достигли точек останова, Visual Studio для Mac приостановит оба процесса. Будет поддерживаться только **шаг с обходом** в активном потоке. Остальные процессы будут приостановлены до тех пор, пока изменение области не позволит отладчику переключить фокус с активного потока. Рассмотрим следующий снимок экрана с отладкой двух проектов в Visual Studio для Mac:

![](multi-process-debugging-images/mpd09-xs.png  "Отладка двух проектов в Visual Studio")

На этом снимке экрана каждое решение имеет собственную точку останова. При запуске отладки первая точка останова находится в **строке 10** класса `MainClass` в проекте **SecondProject**. Поскольку точки останова есть в обоих проектах, останавливается каждый процесс. По достижении точки останова при каждом вызове действия **Шаг с обходом** Visual Studio для Mac будет выполнять шаг с обходом по коду в активном потоке.

Пошаговое выполнение кода ограничивается активным потоком, поэтому Visual Studio для Mac будет обрабатывать по одной строке кода, в то время как другой процесс все еще будет приостановлен.

Воспользуемся предыдущим снимком экрана в качестве примера: по завершении цикла `for` Visual Studio для Mac разрешит выполнение проекта **FirstProject** до обнаружения точки останова в **строке 11** в классе `MainClass`. При каждой команде **Шаг с обходом** отладчик будет построчно перемещаться в проекте **FirstProject**, пока внутренние эвристические алгоритмы Visual Studio для Mac не переключат активный поток обратно на проект  **SecondProject**.

Если точка останова задана только в одном из проектов, будет приостановлен только этот процесс. Другой проект продолжит работу до приостановки разработчиком или добавления точки останова.

### <a name="pausing-and-resuming-a-processes"></a>Приостановка и возобновление процессов

Чтобы приостановить или возобновить процесс, щелкните процесс правой кнопкой мыши и в контекстном меню выберите команду **Приостановить** или **Возобновить**:

![](multi-process-debugging-images/mpd08-xs.png "Приостановка и возобновление на панели потоков")

Внешний вид панели инструментов отладки будет меняться в зависимости от состояния отлаживаемых проектов. При выполнении нескольких проектов на панели инструментов "Отладка" будут отображаться кнопки **Приостановить** и **Возобновить**, если есть по крайней мере один выполняющийся и один приостановленный проект:

![](multi-process-debugging-images/mpd07-xs.png  "Панель инструментов отладки")

При нажатии кнопки **Приостановить** на **панели инструментов "Отладка"** приостанавливаются все отлаживаемые процессы, а при нажатии кнопки **Возобновить** возобновляется работа всех приостановленных процессов.

### <a name="debugging-a-second-project"></a>Отладка второго проекта

После запуска первого проекта в Visual Studio для Mac можно приступить к отладке второго проекта. Запустив первый проект, **щелкните правой кнопкой мыши* второй проект на **панели "Решение"** и выберите пункт **Начать отладку элемента**:

![](multi-process-debugging-images/mpd13-xs.png  "Пункт "Начать отладку элемента"")

## <a name="creating-a-solution-configuration"></a>Создание конфигурации решения

_Конфигурация решения_ указывает Visual Studio для Mac, какой проект следует запустить при инициации сеанса отладки с помощью кнопки **Запустить**. У каждого решения может быть несколько конфигураций. Это позволяет указать запускаемые проекты при отладке проекта.

Чтобы создать новую конфигурацию решения в Xamaring Studio, выполните следующие действия:

1. В Visual Studio для Mac откройте диалоговое окно **Параметры решения**, а затем выберите **Запуск > Конфигурации**:

    ![](multi-process-debugging-images/mpd10-xs.png "Конфигурация решения в диалоговом окне "Параметры решения"")

2. Нажмите кнопку **Создать**, введите имя новой конфигурации решения и нажмите кнопку **ОК**. Новая конфигурация решения появится в окне **Конфигурации**:

    ![](multi-process-debugging-images/mpd11-xs.png  "Задание имени новой конфигурации решения")

3. Выберите новую конфигурацию запуска в списке конфигураций. В диалоговом окне **Параметры решения** появится каждый проект в решении. Выберите каждый проект, который должен быть запущен при инициации сеанса отладки:

    ![](multi-process-debugging-images/mpd12-xs.png "Выбор проекта для запуска")

Теперь на **панели инструментов "Отладка"** отображается конфигурация **MultipleProjects**, позволяющая выполнять отладку двух проектов одновременно.

## <a name="summary"></a>Сводка

В этом руководстве рассматривалась процедура отладки нескольких процессов в Visual Studio для Mac. Здесь приводились некоторые изменения интегрированной среды разработки для поддержки процессов отладки и описывалось связанное поведение.

## <a name="related-links"></a>Связанные ссылки

- [Заметки о выпуске Xamarin Cycle 9](https://releases.xamarin.com/stable-release-cycle-9/)
