---
title: Работа с возможностями
description: Добавление возможностей в приложения часто требует дополнительной подготовки. Это руководство описывает процесс настройки, необходимый для добавления поддержки возможностей приложения.
ms.prod: xamarin
ms.assetid: 98A4676F-992B-4593-8D38-6EEB2EB0801C
ms.technology: xamarin-ios
author: asb3993
ms.author: amburns
ms.date: 05/06/2018
ms.openlocfilehash: e6fc3d38fef7c7c3204d1413911ddfa9a486c67c
ms.sourcegitcommit: e16517edcf471b53b4e347cd3fd82e485923d482
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2018
---
# <a name="working-with-capabilities"></a>Работа с возможностями

_Добавление возможностей в приложения часто требует дополнительной подготовки. В это руководстве описано, как настроить поддержку всех возможностей приложения._

Apple предоставляет разработчикам _возможности_, которые зачастую называют _службами приложений_, как способ расширить функционал и область применения приложений iOS. Возможности позволяют разработчикам реализовать более глубокую интеграцию функций платформы в свои приложения, такие как совершение денежных операций из приложения, использование дополнительных служб устройств, например Siri, а также многое другое.
Эти возможности можно использовать в проектах Xamarin.iOS. Полный список служб представлен ниже:

* Группы приложений
* Связанные домены
* Защита данных
* Game Center
* HealthKit
* HomeKit
* Конфигурация беспроводных периферийных устройств
* iCloud
* Покупки из приложений
* Звук между приложениями
* Apple Pay
* Wallet
* Push-уведомление
* Личная VPN
* Siri
* Карты
* Фоновые режимы
* Обмен связками ключей
* Расширения сети
* Конфигурация хот-спота
* Несколько путей
* Чтение тегов NFC


Возможности можно включить через Visual Studio для Mac и Visual Studio 2017 или вручную на портале разработчиков Apple. Для реализации некоторых возможностей, таких как Wallet, Apple Pay и iCloud, требуется дополнительная настройка идентификаторов приложений.

В этом руководстве описывается порядок реализации каждой из этих служб приложений автоматически (с помощью Visual Studio) и вручную (через центр разработчиков), включая дополнительные необходимые настройки. 

## <a name="adding-app-services"></a>Добавление служб приложений

Чтобы использовать возможности, приложению требуется допустимый профиль подготовки, который содержит идентификатор приложения с соответствующей включенной службой. Создать такой профиль подготовки можно автоматически в Visual Studio для Mac и Visual Studio 2017 или вручную в центре разработчиков Apple.

В этом разделе описано, как использовать автоматическую подготовку Visual Studio или центр разработчиков для реализации большинства возможностей. Существуют некоторые возможности, такие как Wallet, iCloud, Apple Pay и группы приложений, которые требуют дополнительной настройки. Более подробно они описаны в соответствующих руководствах.

> [!IMPORTANT]
> Не все возможности можно добавить и реализовать с помощью автоматической подготовки. Далее приведен список поддерживаемых возможностей:
>
>* HealthKit 
>* HomeKit 
>* Личная VPN 
>* Конфигурация беспроводных периферийных устройств 
>* Звук между приложениями 
>* SiriKit 
>* Хот-спот 
>* Расширения сети 
>* Чтение тегов NFC
>* Несколько путей 
>
>Такие возможности, как push-уведомления, Game Center, покупки из приложений, карты, обмен связками ключей, связанные домены и защита данных в настоящее время не поддерживаются. Чтобы добавить эти возможности, воспользуйтесь подготовкой вручную и следуйте инструкциям в разделе [Центр разработчиков](#devcenter).

## <a name="using-the-ide"></a>Использование интегрированной среды разработки

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

Возможности содержатся в файле **Entitlements.plist** в Visual Studio для Mac. Чтобы добавить возможности, выполните следующие действия:

1. Откройте файл **Info.plist** приложения iOS, выберите схему **Автоматическая подготовка** и вашу команду в поле со списком **Команда**. Если требуется помощь, следуйте указаниям в руководстве по [автоматической подготовке](~/ios/get-started/installation/device-provisioning/automatic-provisioning.md):

    ![Параметр Automatically manage signing (Автоматическое управление подписыванием)](images/manage-signing.png)

2. Откройте файл **Entitlements.plist** и выберите возможности, которые требуется добавить:

    ![Добавление возможностей в файл entitlements.plist](images/image17.png)

    При выборе возможности происходит следующее:
    * Добавление возможности в идентификатор приложения
    * Добавление пары "ключ-значение" назначения в файл Entitlements.plist.

    После выполнения этих задач в Visual Studio для Mac отображается следующее сообщение об успешном выполнении:

    ![Добавление возможностей в файл entitlements.plist](images/image18.png)

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

Возможности содержатся в файле **Entitlements.plist**. Чтобы добавить возможности в Visual Studio 2017, выполните следующие действия:

1. Свяжите Visual Studio 2017 с компьютером Mac, как описано в руководстве [Связывание с компьютером Mac](~/ios/get-started/installation/windows/connecting-to-mac/index.md).

2. Откройте параметры подготовки, выбрав **Проект > Параметры подготовки к работе...**

3. Выберите схему **Автоматическая подготовка** и вашу команду в поле со списком **Команда**. Если требуется помощь, следуйте указаниям в руководстве по [автоматической подготовке](~/ios/get-started/installation/device-provisioning/automatic-provisioning.md):

    ![Параметр Automatically manage signing (Автоматическое управление подписыванием)](images/manage-signing-vs.png)

4. Откройте файл **Entitlements.plist** и выберите возможности, которые требуется добавить. Сохраните файл.

    При сохранении файла **Entitlement.plist** выполняются две операции:

    * Добавление возможности в идентификатор приложения
    * Добавление пары "ключ-значение" назначения в файл Entitlements.plist.

-----


<a name="devcenter" />

## <a name="using-the-developer-center"></a>Использование центра разработчиков

Для использования центра разработчиков необходимо сначала создать идентификатор приложения, а затем создать профиль подготовки с помощью этого идентификатора. Эти шаги детально описаны ниже.

### <a name="creating-an-app-id-with-an-app-service"></a>Создание идентификатора приложения с помощью службы приложения

1.  Перейдите в [центр разработчиков Apple](https://developer.apple.com/account) на Mac (или на узел сборки Mac, если используется компьютер с ОС Windows) и выполните вход.
2.  Выберите **Certificates, Identifiers, and Profiles** (Сертификаты, идентификаторы и профили):

    ![Центр разработчиков Apple](images/image5.png)

3.  В разделе **Identifiers** (Идентификаторы) выберите элемент **App IDs** (ИД приложений):

    ![Выбор ИД приложения в центре разработчиков](images/image6.png)

4.  Чтобы создать идентификатор, в правом верхнем углу нажмите кнопку **+**.
5.  Введите описание идентификатора приложения, выберите явный идентификатор приложения и введите идентификатор пакета в формате `com.domain.appname`. Этот идентификатор пакета должен совпадать с идентификатором пакета в проекте:

    ![Добавление сведений об идентификаторе приложения](images/image7.png)

6.  В разделе **App Services** (Службы приложений) выберите одну или несколько служб, которые требуется добавить в приложение:

    ![Страница выбора служб приложений](images/image8.png)

7.  Нажмите **Continue** (Продолжить).
8.  Подтвердите идентификатор приложения. Каждая служба будет находиться в одном из следующих состояний: **Enabled** (Включено), **Disabled** (Отключено) или **Configurable** (Настраиваемая), как показано ниже. Если указано состояние **Enabled** (Включено), то служба готова для использования в профиле подготовки. Если указано состояние **Configurable** (Настраиваемая), то для использования этой возможности требуется дополнительная настройка. Более подробно такие дополнительные шаги описаны в последующих разделах.

    ![Подтверждение идентификатора приложения](images/image9.png)

9.  Нажмите **Register** (Зарегистрировать), а затем — **Done** (Готово). Только что созданный идентификатор приложения должен отобразиться в списке идентификаторов приложений iOS.


<a name="provisioningprofile" />

### <a name="creating-a-provisioning-profile"></a>Создание профиля подготовки

Теперь необходимо создать профиль подготовки, содержащий этот идентификатор приложения. Выполните следующие действия.

1.  В центре разработчиков Apple выберите **Provisioning Profiles > All** (Профили подготовки > Все):

    ![Раздел выбора профиля подготовки](images/image10.png)

2.  Чтобы создать профиль подготовки, в правом верхнем углу нажмите кнопку **+**.
3.  Выберите тип создаваемого профиля подготовки и нажмите **Continue** (Продолжить):

    ![Раздел выбора профиля подготовки](images/image11.png)

4.  В раскрывающемся списке выберите идентификатор приложения, который был создан выше, и нажмите **Continue** (Продолжить):

    ![Выбор ИД приложения](images/image12.png)

5.  Выберите сертификаты, используемые для подписывания приложения, и нажмите **Continue** (Продолжить):

    ![Создание сертификата](images/image13.png)

6.  Выберите устройства, которые будут включены в этот профиль, и нажмите **Continue** (Продолжить):

    ![Выбор устройств для профиля подготовки](images/image14.png)

7.  Присвойте имя профилю, чтобы его можно было идентифицировать, и нажмите **Continue** (Продолжить) для создания профиля:

    ![Присвоение имени профилю подготовки](images/image15.png)

8.  Нажмите кнопку **Download** (Скачать), чтобы скачать профиль, а затем дважды щелкните файл в Finder, чтобы установить профиль подготовки.

9. Если вы используете Visual Studio, убедитесь, что выбран вариант **Подготовка вручную**.

10. В Visual Studio для Mac или Visual Studio выберите **Параметры проекта > Подписывание пакета** и выберите только что созданный профиль подготовки:

    ![Параметры проекта в Visual Studio для Mac](images/image16.png)

> [!IMPORTANT]
> Также может понадобится задать ключи назначения в файле Entitlement.plist и закрытые ключи в файле Info.plist. Дополнительные сведения об этих назначениях см. в руководстве [Работа с назначениями](~/ios/deploy-test/provisioning/entitlements.md).

<a name="nextsteps" />

## <a name="next-steps"></a>Следующие шаги

После включения возможности на стороне сервера необходимо выполнить ряд действий, чтобы разрешить приложению использовать эту возможность. Ниже перечислены дополнительные действия, которые необходимо выполнить:

*   Используйте в приложении пространство имен платформы.
*   Добавьте необходимые назначения к вашему приложению. Подробные сведения о необходимых назначениях и об их добавлении см. в руководстве [Общие сведения о назначениях](~/ios/deploy-test/provisioning/entitlements.md).

<a name="troubleshooting" />

## <a name="troubleshooting-capabilities"></a>Возможности по устранению неполадок

Ниже описаны некоторые из наиболее распространенных проблем, которые могут создать трудности при разработке приложения со включенной службой приложения.

-   Убедитесь в том, что идентификатор был правильно создан и зарегистрирован в разделе **Certificates, IDs & Profiles** (Сертификаты, идентификаторы и профили) на портале разработчиков Apple.
-   Убедитесь, что служба добавлена в идентификатор приложения (или расширения), а также что служба настроена на использование группы приложений/идентификатора продавца/контейнера, созданных ранее в разделе **Certificates, IDs & Profiles** (Сертификаты, идентификаторы и профили) на портале разработчиков Apple.
-   Убедитесь, что профили подготовки и идентификаторы приложений были установлены, а также что в файле **Info.plist** приложения (в проекте Xamarin) используется один из настроенных выше идентификаторов приложений.
-   Убедитесь, что в файле **Entitlements.plist** приложения (в проекте Xamarin) включена соответствующая служба.
-   Убедитесь, что в файле info.plist заданы соответствующие закрытые ключи.
-   Убедитесь, что в **Подписывании пакета iOS** приложения параметр **Настраиваемые назначения** установлен в **Entitlements.plist**. Эта настройка _не устанавливается_ по умолчанию для сборок отладки и симулятора iOS.

<a name="summary" />

## <a name="summary"></a>Сводка

В этом руководстве описаны возможности или _службы приложений_, а также описан порядок их включения с помощью Visual Studio и в центре разработчиков Apple. В нем также представлены подробные сведения о настройке более сложных служб, таких как Wallet, iCloud, Apple Pay и группы приложений. Наконец, в руководстве рассматриваются дальнейшие действия по настройке и варианты устранения простых неполадок.