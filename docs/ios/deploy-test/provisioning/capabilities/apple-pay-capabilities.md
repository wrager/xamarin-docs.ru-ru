---
title: Возможности Apple Pay
description: Добавление возможностей в приложения часто требует дополнительной подготовки. Это руководство описывает процесс настройки, необходимый для добавления поддержки возможностей Apple Pay.
ms.prod: xamarin
ms.assetid: 735CC916-16A4-471B-87F7-0535E24288D7
ms.technology: xamarin-ios
author: bradumbaugh
ms.author: brumbaug
ms.date: 03/15/2017
ms.openlocfilehash: c389dc4831009d760e4a6a810b5b3c01637c822e
ms.sourcegitcommit: 945df041e2180cb20af08b83cc703ecd1aedc6b0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/04/2018
---
# <a name="apple-pay-capabilities"></a>Возможности Apple Pay

_Добавление возможностей в приложения часто требует дополнительной подготовки. Это руководство описывает процесс настройки, необходимый для добавления поддержки возможностей Apple Pay._

Технология Apple Pay позволяет пользователям оплачивать физические товары при помощи своего устройства iOS. Этот раздел описывает процесс создания всех компонентов, необходимых для Apple Pay в центре разработчика Apple.

При подготовке нового приложения в центре разработчика необходимо выполнить три операции:

1.  Создать ИД продавца.
2.  Создать ИД приложения с возможностями Apply Pay и добавить в него ИД продавца.
3.  Создать сертификат для ИД продавца.

Ниже описывается процедура выполнения этих операций:

<a name="merchantid" />

## <a name="create-merchant-id"></a>Создание ИД продавца

ИД продавца используется для указания Apple Pay, что вы можете принимать платежи, ИД передается в метод PassKit `PaymentRequest` и используется в назначении Apple Pay:

1.  Откройте [Центр разработчика Apple](https://developer.apple.com/account/) и перейдите к разделу "Сертификаты, Идентификаторы и Профили": 
 
    ![Выбор ИД продавца в центре разработчика](apple-pay-capabilities-images/image57.png)

2.  В разделе **Идентификаторы** выберите элемент **ИД продавцов** и затем выберите **+** для добавления ИД продавца:  

3.  Заполните форму, изображенную ниже, с новым описанием и идентификатором. Описание делает идентификатор более понятным и может быть изменено позднее. Идентификатор должен быть уникальным для вас и должен начинаться со строки `merchant`. Корпорация Apple рекомендует использовать идентификатор в следующем формате: `merchant.com.[Your-App-Name]`:
   
    ![Сведения о новом ИД продавца](apple-pay-capabilities-images/image58.png)

4.  Проверьте введенные данные и нажмите кнопку **Регистрация**: 
    
    ![Подтверждение ИД продавца](apple-pay-capabilities-images/image59.png)

<a name="appid" />

## <a name="create-an-app-id-with-the-apple-pay-capability-that-includes-the-merchant-id"></a>Создание ИД приложения с возможностями Apple Pay, включающее ИД продавца

1.  В [Центре разработчика](https://developer.apple.com/account/) нажмите **ИД приложений** в разделе **Идентификаторы**: 
    
    ![Выбор ИД приложения в центре разработчика](apple-pay-capabilities-images/image6.png)

2.  Нажмите кнопку **+** для добавления ИД приложения: 
   
    ![Кнопка "Добавить ИД приложения"](apple-pay-capabilities-images/image27.png)

3.  Введите имя для ИД приложения и понятный идентификатор приложения:    
   
    ![Окно сведений об ИД приложения ](apple-pay-capabilities-images/image35.png)

4.  В "Службах приложений" выберите Apple Pay:    
  
    ![Службы приложения Apple Pay](apple-pay-capabilities-images/image36.png)

5.  Нажмите кнопку **Continue** (Продолжить), а затем кнопку **Register** (Зарегистрировать). Обратите внимание, что в окне подтверждения параметр Apple Pay будет отмечен как "Настраиваемый" при помощи желтого символа: 
   
    ![Окно подтверждения для Apple Pay](apple-pay-capabilities-images/image37.png)

6.  Вернитесь к списку ИД приложений и выберите только что созданный идентификатор:  
   
    ![Изменение ИД приложения](apple-pay-capabilities-images/image38.png)

7.  Прокрутите вниз до конца этого расширенного раздела и нажмите **Изменить**.
8.  Прокрутите список вниз до Apple Pay и нажмите кнопку **Изменить**:  
    
    ![Изменение сведений об Apple Pay в ИД приложения](apple-pay-capabilities-images/image39.png)

9.  Выберите ИД продавца для использования с этим ИД приложения и нажмите **Продолжить**:  
    
    ![Выбор ИД продавца для использования с ИД приложения](apple-pay-capabilities-images/image40.png)

10. Проверьте правильность выбора ИД продавца и нажмите **Назначить**:  
    
    ![Окно подтверждения](apple-pay-capabilities-images/image41.png)

Этот ИД приложения теперь можно использовать для создания или повторного создания профиля подготовки, как описано в руководстве [Работа с возможностями](~/ios/deploy-test/provisioning/capabilities/index.md). 

<a name="certificate" />

## <a name="create-a-certificate-for-your-merchant-id"></a>Создание сертификата для ИД продавца

Сертификат требуется компании Apple для шифрования конфиденциальной информации, связанной с платежом. Каждый ИД продавца должен иметь свой собственный сертификат. 

Для создания сертификата выполните следующее:

1.  Выберите ИД продавца, созданный ранее, и нажмите **Изменить**: 
    
    ![Диалоговое окно редактирования ИД продавца](apple-pay-capabilities-images/image42.png)

2.  В окне "Настройка ИД продавца iOS" нажмите **Создать сертификат**: 
   
    ![Создайте сертификат обработки платежей](apple-pay-capabilities-images/image43.png)

3.  Ответьте на следующий вопрос: 

    ![будут ли платежи выполняться исключительно в Китае](apple-pay-capabilities-images/image44.png)

4.  На этом этапе появится подтверждение на создание _запроса подписи сертификата_: 

    ![Создание запроса подписи сертификата](apple-pay-capabilities-images/image45.png)
    
    > [!IMPORTANT]
    > Если вы пользуетесь услугами поставщика платежных услуг для Apple Pay, такими как JudoPay или Stripe, они могут предоставить вам правильно сформированный CSR-файл, который можно использовать на этом шаге. Сведения о запросе этого файла можно найти на веб-сайтах [JudoPay](https://www.judopay.com/docs/version-52/apple-pay/getting-started/#create-an-apple-pay-certificate) и [Stripe](https://stripe.com/docs/apple-pay/apps#csr). Для создания своего собственного CSR-файла выполните шаги 5–8 ниже. Если у вас уже есть CSR-файл, перейдите к шагу 9.

5.  Откройте приложение "Связка ключей" и перейдите к **Связка ключей > Помощник по сертификатам > Запросить сертификат в центре сертификации:** 

     ![Создание CSR-файла при помощи связки ключей на MAC](apple-pay-capabilities-images/image46.png)

6.  Введите ваш адрес электронной почты и имя закрытого ключа, поле "Адрес эл. почты ЦС" оставьте пустым, выберите параметр **Сохранить на диск** и установите флажок **Позвольте мне указать сведения о паре ключей**:

     ![Диалоговое окно сведений о сертификате](apple-pay-capabilities-images/image47.png)

7.  Сохраните CSR-файл в удобное расположение: 

     ![Сохранение CSR-файла на локальный компьютер](apple-pay-capabilities-images/image48.png)

8.  В окне "Сведения о паре ключей" установите **Размер ключа** в **256 бит**, а **Алгоритм** — в **ECC** и нажмите **Продолжить**:

     ![Диалоговое окно ввода сведений о паре ключей](apple-pay-capabilities-images/image49.png)

9.  Откройте Центр разработчика и нажмите **Продолжить** для отправки CSR-файла: 

     ![Подготовка к отправке CSR-файла в центр разработчика](apple-pay-capabilities-images/image50.png)

10. Щелкните **Выбрать файл...** для выбора CSR-файла и нажмите **Продолжить** для отправки его на портал разработчика: 

     ![Отправка CSR-файла в центр разработчика](apple-pay-capabilities-images/image51.png)

11. После создания сертификата загрузите его и дважды щелкните на нем для установки в вашу связку ключей.

Дополнительные сведения по использованию Apple Pay см. в следующем руководстве:

*   [Введение в Apple Pay](~/ios/platform/apple-pay.md)

## <a name="next-steps"></a>Следующие шаги
 
Ниже перечислены дополнительные действия, которые необходимо выполнить:

* Используйте в приложении пространство имен платформы.
* Добавьте необходимые назначения к вашему приложению. Подробные сведения о необходимых назначениях и об их добавлении см. в руководстве [Работа с назначениями](~/ios/deploy-test/provisioning/entitlements.md).
* Убедитесь, что в **Подписывании пакета iOS** приложения параметр **Настраиваемые назначения** установлен в **Entitlements.plist**. Эта настройка _не устанавливается_ по умолчанию для сборок отладки и симулятора iOS.

Если вы столкнулись с проблемами при работе со службами приложений, обратитесь к разделу [Устранение неполадок](~/ios/deploy-test/provisioning/capabilities/index.md) основного руководства.