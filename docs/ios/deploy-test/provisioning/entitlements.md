---
title: Работа с разрешениями
description: Разрешения (entitlements) предоставляют особые возможности и функции безопасности корректно настроенным для их использования приложениям.
ms.topic: article
ms.prod: xamarin
ms.assetid: 8A3961A2-02AB-4228-A41D-06CB4108D9D0
ms.technology: xamarin-ios
author: bradumbaugh
ms.author: brumbaug
ms.date: 03/15/2017
ms.openlocfilehash: 8b5c88f4af3087f980b586113c274016935585c0
ms.sourcegitcommit: 73bd0c7e5f237f0a1be70a6c1384309bb26609d5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2018
---
# <a name="working-with-entitlements"></a>Работа с разрешениями

_Разрешения (entitlements) предоставляют особые возможности и функции безопасности корректно настроенным для их использования приложениям._

В операционной системе iOS приложения выполняются в _песочнице_, которая устанавливает ряд правил, ограничивающих доступ приложения к определенным ресурсам системы или пользовательским данным. _Назначения_ используются для запроса разрешения у системы на расширение песочницы и предоставление приложению дополнительных возможностей.

Для расширения возможностей вашего приложения необходимо сделать назначение в файле Entitlements.plist вашего приложения. Могут быть расширены только некоторые возможности, их список приведен в руководстве [Работа с возможностями](~/ios/deploy-test/provisioning/capabilities/index.md), а их описание приведено [ниже](#keyreference). Назначения передаются в систему как пара ключ/значение, и обычно достаточно одной пары для каждой возможности. Конкретные ключи и значения описаны в разделе [Справочник по ключам назначений](#keyreference) этого руководства.
Visual Studio для Mac и Visual Studio предоставляют понятный интерфейс для добавления назначений для приложения Xamarin.iOS в редакторе файлов Entitlements.plist.
Это руководство описывает работу в редакторе файлов Entitlements.plist. В руководстве вы также найдете справочник всех назначений, которые можно добавить в проект iOS для каждой возможности.

## <a name="entitlements-and-provisioning"></a>Назначения и подготовка


Файл Entitlements.plist применяется для указания назначений и для подписывания пакета приложения.

Однако требуется дополнительная подготовка, чтобы убедиться в корректности подписанного кода. Используемый профиль подготовки должен содержать ИД приложения, в котором включена требуемая возможность. Сведения о том, как это сделать, см. в руководстве [Работа с возможностями](~/ios/deploy-test/provisioning/capabilities/index.md).

> [!IMPORTANT]
> Файл Entitlements.plist помогает указать правильные свойства приложения с использованием возможностей. Но он не обеспечивает создание профиля подготовки, так как не связан с учетной записью разработчика Apple. Для создания профиля подготовки, для развертывания и распространения приложения вам все еще нужно будет воспользоваться порталом разработчика.

## <a name="set-entitlements-in-a-xamarinios-project"></a>Установка назначений в проекте Xamarin.iOS

В дополнение к выбору и настройке необходимых служб приложения при определении ИД приложения необходимо также в проекте Xamarin.iOS настроить назначения, отредактировав файлы **Info.plist** и **Entitlements.plist**.

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

Для настройки назначений Visual Studio для Mac выполните следующее:

1. В **Обозревателе решений** дважды щелкните файл **Info.plist**, чтобы открыть его для редактирования.
2. В разделе **Целевое приложение iOS** введите имя приложения и **Идентификатор пакета**, который был создан при определении ИД приложения:

  ![](entitlements-images/servicexs01.png "Ввод идентификатора пакета")

3. Сохраните изменения в файле **Info.plist**.
4. В **Обозревателе решений** дважды щелкните файл **Entitlements.plist**, чтобы открыть его для редактирования:

    ![](entitlements-images/servicexs02.png "Редактирование назначений")

5. Выберите и настройте назначения для приложения Xamarin.iOS таким образом, чтобы соответствовать настройкам созданного ранее ИД приложения.
6. Сохраните изменения в файле **Entitlements.plist**.

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

Для настройки назначений в Visual Studio выполните следующее:

1. В **Обозревателе решений** щелкните правой кнопкой на файле **Info.plist**, нажмите **Открыть с помощью…** и выберите **Редактор списка свойств**, чтобы открыть файл для редактирования.
2. В разделе **Целевое приложение iOS** введите имя приложения и **Идентификатор пакета**, который был создан при определении ИД приложения:

  ![](entitlements-images/servicevs01.png "Установка идентификатора пакета")

3. Сохраните изменения в файле **Info.plist**.
4. В **Обозревателе решений** щелкните правой кнопкой на файле **Entitlements.plist**, нажмите **Открыть с помощью…** и выберите **Редактор списка свойств**, чтобы открыть файл для редактирования:

    ![](entitlements-images/servicevs02.png "Редактирование назначений")

    Либо дважды щелкните на файле **Entitlements.plist**, он откроется в Редакторе источника XML, который позволяет устанавливать свойства назначений и значения ключей, как это описано ниже в разделе [Справочник по назначениям](#keyreference).

5. Выберите и настройте назначения для приложения Xamarin.iOS таким образом, чтобы соответствовать настройкам созданного ранее ИД приложения.
6. Сохраните изменения в файле **Entitlements.plist**.


-----

<a name="add-new" />

## <a name="adding-a-new-entitlementsplist-file"></a>Добавление нового файла Entitlements.plist

Назначения добавляются в приложение при помощи файла Entitlements.plist. Этот файл по умолчанию включается в проекты Xamarin.iOS, но может отсутствовать в более ранних проектах.

Для добавления файла Entitlements.plist в проект Xamarin.iOS выполните следующее:

1.  Щелкните правой кнопкой на файле проекта и выберите **Добавить > Новый файл…**:

    ![Контекстное меню добавления файлов](entitlements-images/image1.png)
2.  В диалоговом окне создания файла выберите **iOS > Список свойств** и назовите его "Entitlements":

    ![Диалоговое окно "Новый файл"](entitlements-images/image2.png)

<a name="keyreference" />

## <a name="entitlement-key-reference"></a>Справочник по ключам назначений

Ключи назначений добавляются через панель "Источник" редактора файла Entitlements.plist. Ключи назначений обычно добавляются при использовании редактора файла Entitlements.plist и приводятся здесь для справки.

### <a name="wallet"></a>Wallet

*   **Описание**: приложение Wallet (прежнее название Passbook) хранит карты и управляет ими. Картами могут быть кредитные карты, карты скидок, посадочные талоны или билеты.

    - **Идентификатор типа карты**
        * **Ключи**: com.apple.developer.pass-type-identifiers
        * **Строка**: `$(TeamIdentifierPrefix)*`

* **Примечание**.
    - Это позволит вашему приложение работать со всеми типами карт. Чтобы ограничить работу приложения только с подмножеством типов карт, установите следующее значение строки: `$(TeamIdentifierPrefix)pass.$(CFBundleIdentifier)`

    Здесь pass.$(CFBundleIdentifier) — ИД карты, созданный [выше](~/ios/platform/passkit.md)

<a name="icloud" />

### <a name="icloud"></a>iCloud

*   **Описание**: iCloud позволяет пользователям легко и удобно хранить свои данные и обмениваться ими между устройствами. Существуют четыре способа, с помощью которых разработчики могут использовать iCloud для предоставления пользователям средства хранения данных: хранилище ключ-значение, хранилище UIDocument, CoreData и прямое предоставление хранилища для отдельных файлов и каталогов при помощи CloudKit. Дополнительную информацию см. в руководстве "Введение в iCloud".

    - **Документы iCloud и CloudKit**
        - **Ключи**: com.apple.developer.ubiquity-container-identifiers
        - **Строка**: `$(TeamIdentifierPrefix)$(CFBundleIdentifier)`
    - **Хранилище iCloud KeyValue**
        - **Ключ**: com.apple.developer.ubiquity-kvstore-identifier
        - **Строка**: `$(TeamIdentifierPrefix)$(CFBundleIdentifier)`

* **Примечание**.
    - Строку `$(TeamIdentifierPrefix)` можно получить, если зайти в свой кабинет на сайте developer.apple.com и перейти в раздел **Member Center > Your Account > Developer Account Summary (Центр пользователей > Ваша учетная запись > Сводка об учетной записи разработчика)** для получения своего идентификатора Team ID (или Individual ID в случае единственного разработчика). Идентификатор представляет собой строку длиной 10 символов (например, A93A5CM278).
    - Строка `$(CFBundleIdentifier)` начинается с `iCloud` и имеет значение, когда упакован контейнер iCloud, как это описано в руководстве [Работа с возможностями](~/ios/deploy-test/provisioning/capabilities/icloud-capabilities.md).
    - Заполнители $`(TeamIdentifierPrefix)` и `$(CFBundleIdentifier)` можно использовать, и они будут заменены на правильные значения во время сборки.

### <a name="app-groups"></a>Группы приложений

- **Описание**: использование групп приложений позволяет различным приложениям (или приложению и его расширениям) обращаться к общему месту размещения файлов.

    - **Ключ**: com.apple.security.application-groups
    - **Строка**: group.$(CFBundleIdentifier)

<a name="apple-pay" />

### <a name="apple-pay"></a>Apple Pay

- **Описание**: Apple Pay позволяет пользователям оплачивать физические товары со своего устройства iOS.
    - **Ключ**: com.apple.developer.in-app-payments
    - **Строка**: merchant.your.mechantid

### <a name="push-notifications"></a>Push-уведомления

- **Ключ**: aps-environment
- **Строка**: `production` ИЛИ `development`

### <a name="siri"></a>Siri

- **Описание**: SiriKit позволяет приложению iOS предоставлять услуги, которые будут доступны для Siri и приложения "Карты" на устройстве iOS при помощи расширений приложений и новых инструментов Intents и Intents UI. Подробные сведения см. в руководстве "Введение в SiriKit".
    - **Ключ**: com.apple.developer.siri

### <a name="personal-vpn"></a>Личная VPN

- **Ключ**: com.apple.developer.networking.vpn.api
- **Строка**: allow-vpn

### <a name="keychain-sharing"></a>Обмен связками ключей

- **Описание**: обмен связками ключей позволяет разработчикам приложений предоставлять доступ к паролям, которые хранятся в связке ключей устройства, другим приложениям, разработанным той же командой разработчиков. Доступ может быть ограничен путем передачи в строке идентификатора доступа к связке ключей.
    - **Ключ**: keychain-access-groups
    - **Строка**: $(AppIdentifierPrefix) $(CFBundleIdentifier)

### <a name="inter-app-audio"></a>Звук между приложениями

- **Описание**: функция звука между приложениями позволяет разработчикам передавать аудиопоток из одного приложения в другое.
    - **Ключ**: inter-app-audio
    - **Логическое**: ДА

### <a name="associated-domains"></a>Связанные домены

- **Описание**: связанные домены, которые должны обрабатываться как универсальные ссылки, необходимо передавать с этим назначением. Для обеспечения глубокой связи между приложением и веб-сайтом можно использовать универсальные ссылки. Необходимо создать запись для каждого домена, с которым работает ваше приложение. Каждая запись должна начинаться с `applinks:`
    - **Ключ**: com.apple.developer.associated-domains
    - **Строка**: webcredentials:example.com

### <a name="data-protection"></a>Защита данных

- **Описание**: функция защиты данных использует встроенное оборудование для шифрования для хранения конфиденциальных данных вашего приложения в зашифрованном виде. По умолчанию уровень защиты установлен на полную защиту (файлы доступны только тогда, когда устройство разблокировано).
    - **Ключ**: com.apple.developer.default-data-protection
    - **Строка**: NSFileProtectionComplete

### <a name="homekit"></a>HomeKit

- **Описание**: фреймворк HomeKit предоставляет платформу для установки, настройки и управления поддерживаемыми устройствами для домашней автоматизации — всех с одного устройства iOS. Дополнительные сведения об использовании HomeKit см. в руководстве "Введение в HomeKit".
    - **Ключ**: com.apple.developer.homekit
    - **Логическое**: ДА

### <a name="healthkit"></a>HealthKit

- **Описание**: фреймворк HealthKit впервые появился в iOS 8, он предоставляет централизованное, скоординированное и безопасное хранилище связанных со здоровьем данных. Дополнительные сведения об использовании HealthKit см. в руководстве "Введение в HealthKit".
    - **Ключ**: com.apple.developer.healthkit
    - **Логическое**: ДА

### <a name="wireless-accessory-configuration"></a>Конфигурация беспроводных периферийных устройств

- **Описание**: конфигурация беспроводных периферийных устройств позволяет вашему приложению настраивать периферийные устройства MFi Wi-Fi
    - **Ключ**: com.apple.external-accessory.wireless-configuration
    - **Логическое**: ДА

## <a name="summary"></a>Сводка

Это руководство описывает использование назначений в Visual Studio для Mac и Visual Studio. В нем также приведен справочник пар ключ/значение для каждой возможности.