---
title: Устранение неполадок при подключении
description: В этом руководстве приводятся инструкции по устранению неполадок, которые могут возникнуть при использовании нового диспетчера подключений, в том числе неполадок с подключением и протоколом SSH.
ms.prod: xamarin
ms.assetid: A1508A15-1997-4562-B537-E4A9F3DD1F06
ms.technology: xamarin-ios
author: bradumbaugh
ms.author: brumbaug
ms.date: 03/19/2017
ms.openlocfilehash: 8aac58546e51525ae22c09218f90addef911669a
ms.sourcegitcommit: dc882e9631b4ed52596b944a6fbbdde309346943
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2018
---
# <a name="connection-troubleshooting"></a>Устранение неполадок при подключении

_В этом руководстве приводятся инструкции по устранению неполадок, которые могут возникнуть при использовании нового диспетчера подключений, в том числе неполадок с подключением и протоколом SSH._

## <a name="log-file-location"></a>Расположение файлов журнала

- **Mac**: ~/Library/Logs/Xamarin-[ОСНОВНОЙ НОМЕР ВЕРСИИ.ДОПОЛНИТЕЛЬНЫЙ НОМЕР ВЕРСИИ]
- **Windows**: %LOCALAPPDATA%\Xamarin\Logs

Файлы журнала можно найти, последовательно выбрав в Visual Studio пункты **Справка &gt; Xamarin &gt; Запаковать журналы**.


## <a name="wheres-the-xamarin-build-host-app"></a>Где приложение Xamarin Build Host?

Приложение Xamarin Build Host из предыдущих версий Xamarin.iOS больше не требуется. Visual Studio теперь автоматически развертывает агент посредством удаленного входа и запускает его в фоновом режиме. Ни на компьютере Mac, ни на компьютере Windows дополнительные приложения не выполняются.


## <a name="troubleshooting-remote-login"></a>Устранение неполадок удаленного входа

> [!IMPORTANT]
> Эти инструкции в первую очередь предназначены для решения проблем, возникающих во время начальной настройки новой системы.  Если вы ранее успешно использовали соединения в конкретной среде, а теперь они полностью или периодически перестают работать, вы можете (в большинстве случаев) сразу перейти к проверке следующих методов решения проблемы. 
>   * Прекратите работу всех оставшихся процессов, как описано ниже в разделе [Ошибки, связанные с существующими хост-процессами сборки](#errors). 
>   * Очистите агенты, как описано в статье [Удаление агентов Broker, IDB, сборки и конструктора](#clearing), а затем через проводное подключение к Интернету напрямую откройте нужный IP-адрес, как описано в разделе [Не удается подключиться к MacBuildHost.local. Повторите попытку.](#tryagain)  
> Если ни одно из этих действий не устраняет проблему, следуйте инструкциям в [шаге 9](#stepnine), чтобы отправить отчет об ошибке.

1. Убедитесь в том, что на компьютере Mac установлены совместимые версии Xamarin.iOS. В случае с Visual Studio 2017 для этого следует проверить, используется ли канал распространения **Стабильный** в Visual Studio для Mac. В Visual Studio 2015 и более ранних версиях следует проверить, используется ли один и тот же канал распространения в обеих интегрированных средах разработки.
    * В Visual Studio для Mac выберите пункт меню **Visual Studio для Mac > Проверить обновления...**, чтобы просмотреть или изменить **Канал обновления**.
    * В Visual Studio 2015 или более ранней версии проверьте канал распространения, последовательно выбрав **Сервис > Параметры > Xamarin > Другое**.

2. Проверьте, включена ли на компьютере Mac функция **Удаленный вход**. Разрешите доступ **Только этим пользователям** и убедитесь в том, что ваш пользователь Mac включен в список или группу:

    [![](troubleshooting-images/troubleshooting-image1.png "Разрешение доступа "Только этим пользователям"")](troubleshooting-images/troubleshooting-image1.png#lightbox)

3. Проверьте в брандмауэре, разрешены ли входящие подключения через порт 22 (порт по умолчанию для протокола SSH):

    [![](troubleshooting-images/troubleshooting-image2.png "Проверьте в брандмауэре, разрешены ли входящие подключения через порт 22")](troubleshooting-images/troubleshooting-image2.png#lightbox)

    Если параметр **Автоматически разрешать подписанному ПО входящие подключения** отключен, во время связывания в системе OS X будет появляться диалоговое окно с запросом, следует ли разрешить программе `mono-sgen` или `mono-sgen32` принимать входящие подключения. В этом диалоговом окне необходимо нажать кнопку **Разрешить**:

    [![](troubleshooting-images/troubleshooting-image4a.png "Нажмите кнопку "Разрешить"")](troubleshooting-images/troubleshooting-image4a.png#lightbox)

4. Убедитесь, что на компьютере Mac выполнен вход в учетную запись пользователя и запущен сеанс работы с графическим пользовательским интерфейсом.

5. Используйте для подключения к компьютеру Mac _имя пользователя_, а не _полное имя_. Это позволит избежать известного ограничения, касающегося полных имен, в которых есть символы с диакритическими знаками.

    Чтобы узнать свое _имя пользователя_, можно выполнить команду `whoami` в **Terminal.app**.

    Например, на приведенном ниже снимке экрана имя учетной записи будет **amyb**, а не **Amy Burns**:

    [![](troubleshooting-images/troubleshooting-image5a.png "Получение имени учетной записи с помощью приложения Terminal")](troubleshooting-images/troubleshooting-image5a.png#lightbox)


6. Проверьте правильность IP-адреса, используемого для компьютера Mac. Чтобы узнать IP-адрес, на компьютере Mac последовательно выберите **Системные настройки > Общий доступ > Удаленный вход**.

    [![](troubleshooting-images/troubleshooting-image17.png "IP-адрес в приложении "Системные настройки"")](troubleshooting-images/troubleshooting-image17.png#lightbox)

7. Подтвердив IP-адрес компьютера Mac, попробуйте выполнить запрос `ping` к этому адресу в программе `cmd.exe` в Windows:

    ```
    ping 10.1.8.95
    ```
    
    Если проверка связи завершилась неудачно, значит, возможность маршрутизации от компьютера Windows к компьютеру Mac _отсутствует_. Эту проблему необходимо решить на уровне конфигурации локальной сети между двумя компьютерами. Оба компьютера должны быть в одной локальной сети.

8. Далее проверьте, может ли клиент `ssh` из набора OpenSSH успешно подключиться к компьютеру Mac из Windows. Один из способов установить эту программу — установить [Git для Windows](https://git-for-windows.github.io/). Затем можно открыть окно командной строки **Git Bash** и попытаться выполнить команду `ssh` с указанием имени пользователя и IP-адреса для подключения к компьютеру Mac:

    ```bash
    ssh amyb@10.1.8.95
    ```
    <a name="stepnine" />

9. Если **шаг 8 завершился успешно**, можно попытаться выполнить простую команду, такую как `ls`, через подключение:

    ```bash
    ssh amyb@10.1.8.95 'ls'
    ```
    
    Она должна вывести список содержимого домашнего каталога на компьютере Mac. Если команда `ls` работает правильно, но подключение к Visual Studio по-прежнему не удается установить, можно обратиться к разделу [Известные проблемы и ограничения](#knownissues) за сведениями о проблемах, характерных для Xamarin. Если соответствующая проблема в ней не описывается, [отправьте сообщение о новой ошибке](https://bugzilla.xamarin.com/newbug), приложив журналы, которые указаны в разделе [Проверка подробных файлов журнала](#verboselogs).

10. Если **шаг 8 завершается неудачно**, можно выполнить следующую команду в приложении Terminal на компьютере Mac, чтобы узнать, принимает ли сервер SSH _какие-либо_ подключения:

    ```bash
    ssh localhost
    ```
    
11. Если шаг 8 завершается неудачно, а **шаг 10 — успешно**, проблема, скорее всего, в том, что порт 22 на узле сборки Mac недоступен из Windows из-за конфигурации сети. Ниже перечислены возможные проблемы конфигурации:

    - Параметры брандмауэра OS X запрещают подключение. Еще раз проверьте шаг 3.

        Иногда конфигурация брандмауэра OS X для отдельного приложения может приводить к недопустимому состоянию, при котором параметры в программе "Системные настройки" не соответствуют фактической ситуации. Чтобы восстановить поведение по умолчанию, можно удалить файл конфигурации (**/Library/Preferences/com.apple.alf.plist**) и перезагрузить компьютер. Один из способов удалить этот файл — ввести путь **/Library/Preferences** в поле **Переход &gt; Переход к папке** в программе Finder, а затем переместить файл **com.apple.alf.plist** в Корзину.

    - Заданные в брандмауэре параметры одного из маршрутизаторов между компьютерами Mac и Windows блокируют подключение.

    - Исходящие подключения к удаленному порту 22 запрещены в самой системе Windows. Это необычная ситуация. В брандмауэре Windows можно запретить исходящие подключения, но по умолчанию они разрешены.

    - Узел сборки Mac запрещает доступ к порту 22 из всех внешних узлов посредством правила `pfctl`. Это маловероятно, если только вы не настраивали правило `pfctl` в прошлом.

12. Если **шаги 8 и 10 завершаются неудачно**, проблема, скорее всего, в том, что процесс сервера SSH на компьютере Mac не запущен или не разрешает вход текущего пользователя в систему. В этом случае еще раз проверьте параметры удаленного входа из шага 2, прежде чем переходить к более сложным причинам.

<a name="knownissues" />

### <a name="known-issues-and-limitations"></a>Известные проблемы и ограничения

> [!NOTE]
> Сведения в этом разделе применимы только в том случае, если вы уже успешно подключились к узлу сборки Mac с указанием имени пользователя и пароля Mac с помощью клиента SSH из набора OpenSSH, как указано в шагах 8 и 9 выше.

#### <a name="invalid-credentials-please-try-again"></a>"Недопустимые учетные данные. Повторите попытку."

Известные причины:

- **Ограничение** — эта ошибка может возникнуть при попытке войти на узел сборки с помощью _полного имени_ учетной записи, если в нем есть символ с диакритическим знаком. Это ограничение [библиотеки SSH.NET](https://sshnet.codeplex.com/), которая применяется в Xamarin для SSH-подключений. **Обходной путь**: см. шаг 5 выше.

#### <a name="unable-to-authenticate-with-ssh-keys-please-try-to-log-in-with-credentials-first"></a>"Не удалось выполнить проверку подлинности с помощью ключей SSH. Сначала попытайтесь войти, используя учетные данные"

Известная причина:

- **Ограничение безопасности SSH** — чаще всего это сообщение означает, что _другим_ пользователям или участникам _группы_ предоставлены разрешения на запись в один из файлов или каталогов, находящихся по полному пути **$HOME/.ssh/authorized\_keys** на компьютере Mac. **Обычное исправление**: выполните команду `chmod og-w "$HOME"` в окне командной строки Terminal на компьютере Mac. Чтобы узнать, какой именно файл или каталог вызывает проблему, выполните команду `grep sshd /var/log/system.log > "$HOME/Desktop/sshd.log"` в приложении Terminal, а затем откройте файл **sshd.log** на компьютере и найдите запись "Authentication refused: bad ownership or modes" (Проверка подлинности отклонена: неправильное владение или режимы).

#### <a name="trying-to-connect-never-completes"></a>Сообщение "Попытка подключения..." не пропадает

- **Ошибка [№ 52264](https://bugzilla.xamarin.com/show_bug.cgi?id=52264)**  — эта проблема может происходить в Xamarin 4.1, если параметр **Оболочка входа** в окне **Дополнительные параметры**, доступном через контекстное меню для пользователя Mac в окне **Системные настройки &gt; Пользователи и группы**, имеет значение, отличное от **/bin/bash**. (Начиная с версии Xamarin 4.2, в этом случае появляется сообщение об ошибке "Не удалось подключиться".) **Обходной путь**: измените значение параметра **Оболочка входа** на исходное значение по умолчанию **/bin/bash**.

<a name="tryagain" />

#### <a name="couldnt-connect-to-macbuildhostlocal-please-try-again"></a>"Не удалось подключиться к MacBuildHost.local. Повторите попытку."

Известные причины:

- **Ошибка** — у ряда пользователей появлялось это сообщение об ошибке и более подробное сообщение в файлах журнала "При настройке SSH для пользователя произошла непредвиденная ошибка. Истекло время ожидания операции сеанса" при попытке войти на узел сборки с помощью учетной записи пользователя домена из Active Directory или другой службы каталогов. **Обходной путь**: для входа на узел сборки используйте вместо этого локальную учетную запись пользователя.

- **Ошибка** — у некоторых пользователей эта ошибка возникала при попытке подключиться к узлу сборки, дважды щелкнув имя компьютера Mac в диалоговом окне подключения. **Возможное решение**: [добавьте компьютер Mac вручную](~/ios/get-started/installation/windows/connecting-to-mac/index.md#manually-add-a-mac), указав IP-адрес.

- **Ошибка [№ 35971](https://bugzilla.xamarin.com/show_bug.cgi?id=35971)**  — у некоторых пользователей эта ошибка возникала при использовании беспроводного сетевого соединения между узлом сборки Mac и компьютером Windows. **Возможное решение**: установите между компьютерами проводное соединение.

- **Ошибка [№ 36642](https://bugzilla.xamarin.com/show_bug.cgi?id=36642)**  — в Xamarin 4.0 это сообщение появляется каждый раз, когда файл **$HOME/.bashrc** на компьютере Mac содержит ошибку. (Начиная с версии Xamarin 4.1, ошибки в файле **BASHRC** больше не влияют на процесс подключения.) **Обходной путь**: перенесите файл **BASHRC** в резервное место (или удалите его, если он точно не нужен).

- **Ошибка [№ 52264](https://bugzilla.xamarin.com/show_bug.cgi?id=52264)**  — эта ошибка может возникать, если параметр **Оболочка входа** в окне **Дополнительные параметры**, доступном через контекстное меню для пользователя Mac в окне **Системные настройки > Пользователи и группы**, имеет значение, отличное от **/bin/bash**. **Обходной путь**: измените значение параметра **Оболочка входа** на исходное значение по умолчанию **/bin/bash**.

- **Ограничение** — эта ошибка может возникнуть, если узел сборки Mac подключен к маршрутизатору без доступа к Интернету (или если компьютер Mac использует DNS-сервер, при направлении к которому запроса на обратный поиск компьютера Windows в DNS истекает время ожидания). Visual Studio потребуется приблизительно 30 секунд для получения отпечатка SSH, и в конечном итоге подключение установить не удастся.

    **Возможное решение**: добавьте параметр "UseDNS no" в файл **sshd\_config**. Перед изменением этого параметра SSH обязательно ознакомьтесь с его назначением, например на странице по адресу [unix.stackexchange.com/questions/56941/what-is-the-point-of-sshd-usedns-option](http://unix.stackexchange.com/questions/56941/what-is-the-point-of-sshd-usedns-option).

    Ниже описывается один из способов изменения этого параметра. Для выполнения этих действий необходимо войти на компьютер Mac, используя учетную запись администратора.

    1. Проверьте расположение файла **sshd\_config**, выполнив команды `ls /etc/ssh/sshd_config` и `ls /etc/sshd_config` в окне командной строки Terminal. При выполнении дальнейших инструкций используйте расположение, которое _не_ возвращает результат "Нет такого файла или каталога".

        [![](troubleshooting-images/troubleshooting-image18.png "Выполнение команд "ls /etc/ssh/sshd_config" и "ls /etc/sshd_config" в программе Terminal")](troubleshooting-images/troubleshooting-image18.png#lightbox)

    3. Выполните команду `cp /etc/ssh/sshd_config "$HOME/Desktop/"` в программе Terminal, чтобы скопировать файл на рабочий стол.

    4. Откройте файл с рабочего стола в текстовом редакторе. Например, можно выполнить в программе Terminal команду `open -a TextEdit "$HOME/Desktop/sshd_config"`.

    5. Добавьте следующую строку в конец файла:

        ```
        UseDNS no
        ```
        
    6. Удалите все строки с текстом `UseDNS yes`, чтобы новый параметр вступил в силу.

    7. Сохраните файл.

    8. Выполните в программе Terminal команду `sudo cp "$HOME/Desktop/sshd_config" /etc/ssh/sshd_config`, чтобы скопировать измененный файл в прежнее место. Если необходимо, введите пароль.

    9. Отключите, а затем повторно включите параметр **Удаленный вход** в окне **Системные настройки &gt; Общий доступ &gt; Удаленный вход**, чтобы перезапустить сервер SSH.

<a name="clearing" />

#### <a name="clearing-the-broker-idb-build-and-designer-agents-on-the-mac"></a>Удаление агентов Broker, IDB, сборки и конструктора на компьютере Mac

Если в файлах журнала есть указания на проблемы на этапах установки, отправки или запуска каких-либо агентов Mac, можно попытаться удалить папку кэша **XMA**, чтобы агенты были отправлены в Visual Studio повторно.

1. В программе Terminal на компьютере Mac выполните следующую команду:

    ```bash
    open "$HOME/Library/Caches/Xamarin"
    ```
    
2. Щелкните папку **XMA**, удерживая нажатой клавишу CONTROL, и выберите команду **Переместить в Корзину**:

    [![](troubleshooting-images/troubleshooting-image8.png "Перемещение папки XMA в корзину")](troubleshooting-images/troubleshooting-image8.png#lightbox)

3. В Windows также есть кэш, который может быть полезно очистить. Откройте в Windows командную строку как администратор:

    ```
    del %localappdata%\Temp\Xamarin\XMA
    ```
    
### <a name="warning-messages"></a>Предупреждающие сообщения

В этом разделе описывается ряд сообщений в окнах вывода и журналах, которые обычно можно игнорировать.

#### <a name="there-is-a-mismatch-between-the-installed-xamarinios--and-the-local-xamarinios"></a>"Платформа Xamarin.iOS... не соответствует локальной платформе Xamarin.iOS"

Если вы убедились в том, что как на компьютере Mac, так и на компьютере Windows используется один и тот же канал распространения Xamarin, это предупреждение можно игнорировать.

#### <a name="failed-to-execute-ls-usrbinmono-exitstatus1"></a>"Не удалось выполнить "ls /usr/bin/mono": ExitStatus=1"

Это сообщение можно игнорировать, если на компьютере Mac используется OS X 10.11 (El Capitan) или более поздней версии. В системе OS X 10.11 это сообщение не свидетельствует о проблеме, так как платформа Xamarin также проверяет путь **/usr/local/bin/mono**, который является ожидаемым расположением программы `mono` в OS X 10.11.

#### <a name="bonjour-service-macbuildhost-did-not-respond-with-its-ip-address"></a>"Служба Bonjour "MacBuildHost" не ответила со своим IP-адресом."

Это сообщение можно игнорировать, кроме случаев, когда в диалоговом окне подключения не отображается IP-адрес узла сборки Mac. Если IP-адрес в этом диалоговом окне _отсутствует_, вы все же можете [добавить компьютер Mac вручную](~/ios/get-started/installation/windows/connecting-to-mac/index.md#manually-add-a-mac).

#### <a name="invalid-user-a-from-101895-and-inputuserauthrequest-invalid-user-a-preauth"></a>"Недопустимый пользователь a из 10.1.8.95" и "input\_userauth\_request: недопустимый пользователь a [preauth]"

Эти сообщения можно увидеть в файле **sshd.log**. Они появляются в рамках стандартного процесса подключения. Причина в том, что платформа Xamarin временно использует имя пользователя **a** при получении _отпечатка SSH_.

### <a name="output-window-and-log-files"></a>Окно вывода и файлы журнала

Если при подключении к узлу сборки в Visual Studio возникает ошибка, дополнительные сообщения можно найти в двух местах: окне вывода и файлах журнала.

#### <a name="output-window"></a>Окно выходных данных

Лучше всего начать с окна вывода. В нем выводятся сообщения об основных этапах подключения и ошибках. Чтобы просмотреть сообщения Xamarin в окне вывода, выполните указанные ниже действия:

1. Выберите в меню пункт **Вид > Вывод** или перейдите на вкладку **Вывод**.
2. Откройте раскрывающееся меню **Показать выходные данные из**.
3. Выберите пункт **Xamarin**.

[![](troubleshooting-images/troubleshooting-image11.png "Выбор Xamarin на вкладке "Вывод"")](troubleshooting-images/troubleshooting-image11.png#lightbox)

#### <a name="log-files"></a>Файлы журнала

Если в окне вывода недостаточно информации для диагностики проблемы, далее следует обратиться к файлам журнала. Файлы журнала содержат дополнительные диагностические сообщения, которые не отображаются в окне вывода. Чтобы просмотреть файлы журнала, выполните указанные ниже действия:

1. Запустите Visual Studio.

    > [!IMPORTANT]
    > Обратите внимание на то, что файлы **.svclogs** не включены по умолчанию. Для доступа к ним необходимо запустить Visual Studio с подробным ведением журнала, как описывается в руководстве [Журналы версий](~/cross-platform/troubleshooting/questions/version-logs.md#visual-studio-startup-verbose-logs). Дополнительные сведения см. в записи блога [Troubleshooting Extensions with the Activity Log](https://blogs.msdn.microsoft.com/visualstudio/2010/02/24/troubleshooting-extensions-with-the-activity-log/) (Устранение неполадок расширений с помощью журнала действий).

2. Попытайтесь подключиться к узлу сборки.

3. После того как в Visual Studio произойдет ошибка подключения, соберите журналы с помощью команды **Справка > Xamarin > Запаковать журналы**:

    [![](troubleshooting-images/troubleshooting-image12.png "Сбор журналов с помощью команды "Справка > Xamarin > Запаковать журналы"")](troubleshooting-images/troubleshooting-image12.png#lightbox)

4. Когда вы откроете файл ZIP, вы увидите список файлов, как в примере ниже. Для ошибок подключения наиболее важными файлами являются **\*Ide.log** и **\*Ide.svclog**. Эти файлы содержат одни и те же сообщения в двух немного разных форматах. Файл **SVCLOG** содержит данные в формате XML и полезен для просмотра сообщений. Файл **LOG** содержит обычный текст и полезен для фильтрации сообщений с помощью программ командной строки.

    Для просмотра всех сообщений выберите и откройте файл **SVCLOG**:

    [![](troubleshooting-images/troubleshooting-image13.png "Выбор файла SVCLOG")](troubleshooting-images/troubleshooting-image13.png#lightbox)

5. Файл **SVCLOG** откроется в программе **Microsoft Service Trace Viewer**. Сообщения можно группировать в потоки для просмотра связанных сообщений. Для просмотра по потокам выберите вкладку **Диаграмма** и в раскрывающемся меню **Режим макета** выберите пункт **Поток**:

    [![](troubleshooting-images/troubleshooting-image14.png "Выбор пункта "Поток" в раскрывающемся меню "Режим макета"")](troubleshooting-images/troubleshooting-image14.png#lightbox)

<a name="verboselogs" />

#### <a name="verbose-log-files"></a>Подробное ведение журнала

Если в обычных файлах журнала все же недостаточно сведений для диагностики проблемы, последнее средство — включить подробное ведение журнала. Сведения из подробных журналов также желательно включать в отчеты об ошибках.

1. Выйдите из Visual Studio.

2. Запустите [**Командную строку разработчика**](https://msdn.microsoft.com/library/ms229859(v=vs.110).aspx).

3. Чтобы запустить Visual Studio с подробным ведением журнала, выполните в командной строке следующую команду:

    ```bash
    devenv /log
    ```

4. Попытайтесь подключиться к узлу сборки из Visual Studio.

5. После того как в Visual Studio произойдет ошибка подключения, соберите журналы с помощью команды **Справка > Xamarin > Запаковать журналы**.

6. В программе Terminal на компьютере Mac выполните следующую команду, чтобы скопировать все недавние сообщения журнала с сервера SSH в файл на рабочем столе:

    ```bash
    grep sshd /var/log/system.log > "$HOME/Desktop/sshd.log"
   ```

Если в файлах подробного журнала недостаточно прямых указаний для решения проблемы, [отправьте отчет о новой ошибке](https://bugzilla.xamarin.com/newbug) и вложите в него как файл ZIP из шага 5, так и файл LOG из шага 6.

## <a name="troubleshooting-automatic-mac-provisioning"></a>Устранение неполадок автоматической подготовки Mac

### <a name="ide-log-files"></a>Файлы журналов IDE

Если у вас возникают проблемы с [автоматической подготовкой компьютера Mac](~/ios/get-started/installation/windows/connecting-to-mac/index.md#automatic-mac-provisioning), просмотрите журналы IDE Visual Studio 2017 по пути **%LOCALAPPDATA%\Xamarin\Logs\15.0**.

## <a name="troubleshooting-build-and-deployment-errors"></a>Устранение ошибок сборки и развертывания

В этом разделе рассматривается ряд проблем, которые могут возникать после успешного подключения Visual Studio к узлу сборки.

### <a name="unable-to-connect-to-address1921681222-with-usermacuser"></a>"Не удается подключиться к адресу=192.168.1.2:22 с помощью пользователя=macuser"

Известные причины:

- **Функция безопасности Xamarin 4.1** — эта ошибка _возникает_ при переходе на Xamarin 4.0 с Xamarin 4.1 или более поздней версии. В этом случае ошибка сопровождается дополнительным предупреждением "Закрытый ключ зашифрован, но парольная фраза пуста". Это _намеренное_ изменение из-за новой функции безопасности в Xamarin 4.1. **Рекомендованное исправление**: удалите **id\_rsa** и **id\_rsa.pub** из папки **%LOCALAPPDATA%\Xamarin\MonoTouch**, а затем повторно подключитесь к узлу сборки Mac.

- **Ограничение безопасности SSH** — если это сообщение сопровождается дополнительным предупреждением "Не удалось проверить подлинность пользователя с помощью существующих ключей ssh", чаще всего это означает, что _другим_ пользователям или участникам _группы_ предоставлены разрешения на запись в один из файлов или каталогов, находящихся по полному пути **$HOME/.ssh/authorized\_keys** на компьютере Mac. **Обычное исправление**: выполните команду `chmod og-w "$HOME"` в окне командной строки Terminal на компьютере Mac. Чтобы узнать, какой именно файл или каталог вызывает проблему, выполните команду `grep sshd /var/log/system.log > "$HOME/Desktop/sshd.log"` в приложении Terminal, а затем откройте файл **sshd.log** на компьютере и найдите запись "Authentication refused: bad ownership or modes" (Проверка подлинности отклонена: неправильное владение или режимы).

### <a name="solutions-cannot-be-loaded-from-a-network-share"></a>Решения невозможно загружать из сетевой папки

Решения будут компилироваться, только если они находятся в локальной файловой системе Windows или на подключенном диске.

Решения, сохраненные в сетевой папке, могут вызывать ошибки или не компилироваться вообще. Все файлы **SLN**, используемые в Visual Studio, должны сохраняться в локальной файловой системе Windows.

Из-за этой проблемы возникает следующая ошибка:

```bash
error : Building from a network share path is not supported at the moment. Please map a network drive to '\\SharedSources\HelloWorld\HelloWorld' or copy the source to a local directory.
```

Связанная ошибка: [№ 36195](https://bugzilla.xamarin.com/show_bug.cgi?id=36195)

### <a name="missing-provisioning-profiles-or-failed-to-create-the-a-fat-library-error"></a>Отсутствуют профили подготовки или ошибка "Failed to create the a fat library" (Не удалось создать толстую библиотеку)

Запустите Xcode на компьютере Mac и убедитесь в том, что выполнен вход в учетную запись разработчика Apple и профиль разработки iOS скачан:

[![](troubleshooting-images/troubleshooting-image7.png "Убедитесь в том, что выполнен вход в учетную запись разработчика Apple и профиль разработки iOS скачан")](troubleshooting-images/troubleshooting-image7.png#lightbox)

### <a name="a-socket-operation-was-attempted-to-an-unreachable-network"></a>"Попытка доступа к недействующей сети при выполнении операции над сокетом"

Известные причины:

- **Улучшение [№ 36118](https://bugzilla.xamarin.com/show_bug.cgi?id=36118)**  — эта ошибка может препятствовать успешной сборке, когда среда Visual Studio использует адрес IPv6 для подключения к узлу сборки. (Для подключения к узлу сборки адреса IPv6 пока не поддерживаются.)

### <a name="xamarinios-visual-studio-plugin-fails-to-load-after-reinstallation-of-betaalpha-channel"></a>Подключаемый модуль Xamarin.iOS для Visual Studio не загружается после повторной установки канала бета- или альфа-версии

Связанная ошибка: [№ 40781](https://bugzilla.xamarin.com/show_bug.cgi?id=40781).

Эта проблема может происходить, когда среде Visual Studio не удается обновить кэш компонентов MEF. В этом случае может помочь установка этого расширения Visual Studio: [https://visualstudiogallery.msdn.microsoft.com/22b94661-70c7-4a93-9ca3-8b6dd45f47cd](https://visualstudiogallery.msdn.microsoft.com/22b94661-70c7-4a93-9ca3-8b6dd45f47cd)

Оно очищает кэш компонентов MEF Visual Studio для устранения проблем, связанных с его повреждением.

<a name="errors" />

### <a name="errors-due-to-existing-build-host-processes-on-the-mac"></a>Ошибки из-за существующих процессов узла сборки на компьютере Mac

Процессы, связанные с предыдущими подключениями к узлу сборки, иногда могут мешать работе текущего активного подключения. Чтобы проверить наличие существующих процессов, закройте Visual Studio, а затем выполните следующие команды в программе Terminal на компьютере Mac:

```bash
ps -A | grep mono
```

[![](troubleshooting-images/troubleshooting-image10.png "Выполнение команд в программе Terminal на компьютере Mac")](troubleshooting-images/troubleshooting-image10.png#lightbox)

Чтобы завершить существующие процессы, выполните следующую команду:

```bash
killall mono
```

### <a name="clearing-the-mac-build-cache"></a>Очистка кэша сборки Mac

Если вы устраняете неполадку сборки и хотите убедиться в том, что она не связана с временными файлами сборки, хранящимися на компьютере Mac, вы можете удалить папку кэша сборки.

1. В программе Terminal на компьютере Mac выполните следующую команду:

    ```bash
    open "$HOME/Library/Caches/Xamarin"
    ```

2. Щелкните папку **mtbs**, удерживая нажатой клавишу CONTROL, и выберите команду **Переместить в Корзину**:

    [![](troubleshooting-images/troubleshooting-image9.png "Перемещение папки mtbs в корзину")](troubleshooting-images/troubleshooting-image9.png#lightbox)


## <a name="related-links"></a>Связанные ссылки

- [Связывание с компьютером Mac](~/ios/get-started/installation/windows/connecting-to-mac/index.md)
- [Xamarin Mac Build Agent - Xamarin University Lightning Lecture](https://www.youtube.com/watch?v=MBAPBtxkjFQ)
