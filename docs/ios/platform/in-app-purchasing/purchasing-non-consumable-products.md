---
title: "Приобретение невоспроизводимых продуктов"
ms.topic: article
ms.prod: xamarin
ms.assetid: 635D9CA2-6BCA-53E1-7B10-968029AA3493
ms.technology: xamarin-ios
author: bradumbaugh
ms.author: brumbaug
ms.date: 03/18/2017
ms.openlocfilehash: f5fbd2282dc2f1d5e9a3fa6d29e7b74fde89fc42
ms.sourcegitcommit: 6cd40d190abe38edd50fc74331be15324a845a28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/27/2018
---
# <a name="purchasing-non-consumable-products"></a>Приобретение невоспроизводимых продуктов

Продукты не потребляемых «принадлежат» клиента. Ожидается, что они всегда будет доступ к ним, даже если устройство потеряно или украдено, или они приобрести его. Они полезны для книг, журнал проблем, игры уровни, фото фильтры, «pro компонентов», и т. д. Как только пользователь приобретал невоспроизводимых продукта, им не придется оплачивать его еще раз. Если код случайно позволяет его попробовать, StoreKit отобразится сообщение, которое оно уже было куплено.

## <a name="non-consumable-products-sample"></a>Образец невоспроизводимых продуктов

[Кода InAppPurchaseSample](https://developer.xamarin.com/samples/monotouch/StoreKit/) содержит проект с именем *NonConsumables*. В образце кода показано, как реализовать невоспроизводимых продуктов, используя фильтры фотографий в качестве примера. После приобретенными фильтра его можно применить к фотографии снова и снова. Никогда не потребуется повторно его приобретения.   
   
   
   
 Процесс приобретения отображается в этой серии снимки экрана — **купить** кнопка становится кнопкой активацию компонентов:   
   
   
   
 [ ![](purchasing-non-consumable-products-images/image34.png "В этой серии снимки экрана отображается процесса покупки")](purchasing-non-consumable-products-images/image34.png)   
   
   
   
 Процесс приобретения является таким же, как к использованию продукта; Ключевое различие состоит в способ отслеживания покупки в коде приложения. В этом примере кнопка Покупка только в том доступен, если продукт уже не приобретена, в противном случае кнопка активирует сама эта функция.   
   
   
   

На следующей диаграмме показаны взаимодействия между классами и сервере магазина для выполнения покупки невоспроизводимых продукта:   
   
   
   
 [ ![](purchasing-non-consumable-products-images/image35.png "Взаимодействие между классами и сервере магазина для выполнения продукта невоспроизводимых на покупку")](purchasing-non-consumable-products-images/image35.png)   
   
   
   
 Из примера к использованию ключевое различие состоит в том, что после завершения покупки пользовательского интерфейса обновляется для предотвращения повторного приобретения. В этом примере уведомление об успешной транзакция обновляет пользовательский интерфейс, чтобы **купить** кнопка преобразуется в кнопку, которая активирует сама эта функция.

## <a name="re-purchasing-non-consumable-products"></a>Повторно приобрести невоспроизводимых продуктов

Код обычно следует скрыть или переназначить кнопку Покупка после продукта успешно приобретенной, запрет для пользователя при попытке приобрести продукта еще раз. Образец приложения осуществляется путем изменения **купить** кнопки в кнопки, которая делает фильтр фото пример работать.   
   
   
   
 Существуют ситуации, где приложение не может определить ли невоспроизводимых продукта уже был приобретен.

-  Если приложение удаляется и повторно установить на устройстве, все покупки записи будут удалены (если / пока пользователь имеет резервного копирования восстановления). 
-  Если у пользователя есть приложение установлено на устройствах, два (или более) и совершает покупку через одно из устройств. Другие устройства будут отображать продуктов, доступных для приобретения. 
-  Если клиент пытается повторно купят товар невоспроизводимых в таких ситуациях, продукт бесплатно снова будет подставляться в магазине приложений. Пользовательский интерфейс, изначально будет отображаться для выполнения покупки (например, отображается предупреждение подтверждения и требуется идентификатор Apple ID) тем не менее пользователь увидят сообщение, предупреждающее о том, что продукт уже было куплено.  
   
   
   
 Путь кода в этом случае идентичен регулярного покупки, единственными отличиями являются:

-  Пользователь не выставляется снова для продукта.
-  `SKPaymentTransaction` Объекта, переданного в приложение будет иметь `OriginalTransaction` свойство, которое ссылается на транзакцию, который был создан при продукта изначально была приобретена. 
-  Приложения, которые продавать товары потребляемые не должны также реализовать в StoreKit **восстановить** функции, чтобы помочь пользователям получить существующие покупки. 
