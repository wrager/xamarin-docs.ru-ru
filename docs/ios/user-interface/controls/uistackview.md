---
title: "Представление стека"
description: "В этой статье рассказывается, упорядоченные по горизонтали или вертикали стека с помощью нового элемента управления UIStackView в приложении Xamarin.iOS на управление набором представлений в одном."
ms.topic: article
ms.prod: xamarin
ms.assetid: 20246E87-2A49-438A-9BD7-756A1B50A617
ms.technology: xamarin-ios
ms.custom: xamu-video
author: bradumbaugh
ms.author: brumbaug
ms.date: 03/20/2017
ms.openlocfilehash: 82bcd29a201be01bc8123e313e5a76b82668cb85
ms.sourcegitcommit: 30055c534d9caf5dffcfdeafd6f08e666fb870a8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2018
---
# <a name="stack-view"></a>Представление стека

_В этой статье рассказывается, упорядоченные по горизонтали или вертикали стека с помощью нового элемента управления UIStackView в приложении Xamarin.iOS на управление набором представлений в одном._

> [!IMPORTANT]
> Обратите внимание, что хотя StackView поддерживается в конструкторе iOS, могут появиться ошибки удобство использования при использовании стабильный канала. Переключение каналов бета-версии или альфа-канал должен устранить эту проблему. Мы решили представить в данном пошаговом руководстве, с помощью Xcode до исправления, необходимые, реализованных в стабильной канала.

Элемент управления View стека (`UIStackView`) использует возможности автоматический макет и размер классы для управления стек представлений, горизонтально или вертикально, который динамически реагировать ориентации и размера экрана устройства iOS.

В зависимости от разработчика определенные свойства, такие как оси, распространение, выравнивание и интервал управляются макет всех представлений прикреплено к представлению стека:

[![](uistackview-images/stacked01.png "Диаграмма макета представление стека")](uistackview-images/stacked01.png#lightbox)

При использовании `UIStackView` в приложении Xamarin.iOS, разработчик может определить либо представлений, либо внутри раскадровки в iOS конструктора или путем добавления и удаления представлений в коде C#.

Этот документ состоит из двух частей: Краткое руководство для помощи в реализации, просматривать ваш первый стека и затем некоторые дополнительные технические сведения о том, как он работает.

> [!VIDEO https://youtube.com/embed/p3po6507Ip8]

**UIStackView, по [университета Xamarin](https://university.xamarin.com/)**

## <a name="uistackview-quickstart"></a>Краткое руководство UIStackView

Как краткое введение в `UIStackView` управления, мы собираемся создать простой интерфейс, который позволяет пользователю проставить рейтинговые баллы от 1 до 5. Мы будем использовать два стека представления: одно для упорядочения интерфейса на устройстве экрана и один для упорядочения значков оценку 1 – 5 по горизонтали на экране по вертикали.

### <a name="define-the-ui"></a>Определения пользовательского интерфейса

Создание нового проекта Xamarin.iOS и изменить **Main.storyboard** файл в Xcode интерфейс построителя. Во-первых, перетащите один **представления по вертикали стека** на **View Controller**:

[![](uistackview-images/quick01.png "Перетащите отдельное представление вертикальный стек представление-контроллер")](uistackview-images/quick01.png#lightbox)

В **инспектора атрибут**, задайте следующие параметры:

[![](uistackview-images/quick02.png "Задание параметров представление стека")](uistackview-images/quick02.png#lightbox)

Где:

- **Оси** — определяет, если представление стека упорядочивает представлений либо **по горизонтали** или **по вертикали**.
- **Выравнивание** — управляет выравниванием представлений в представление стека.
- **Распределение** — определяет способ изменения размеров представлений в представление стека.
- **Интервал между** — определяет минимальное расстояние между каждой вложенное представление в представление стека.
- **Относительно базовой линии** — Если этот флажок установлен, вертикальный интервал каждого вложенное представление будет производным от базового плана ее.
- **Макет полей относительного** — помещает представлений относительно стандартного поля.

При работе с представление стека, можно представить **выравнивание** как **X** и **Y** расположение вложенное представление и **распространения** как **Высота** и **ширина**.

> [!IMPORTANT]
> **Примечание:** `UIStackView` разработана как представление контейнера без отрисовки и таким образом, он не рисуется на холст, как и другие подклассы `UIView`. Поэтому такие как при задании свойства `BackgroundColor` или переопределение `DrawRect` не будет действовать visual.

Продолжать макет интерфейса приложения путем добавления метки, ImageView, две кнопки и горизонтальное представление стека, как показано ниже:

[![](uistackview-images/quick03.png "Размещение пользовательского интерфейса представление стека")](uistackview-images/quick03.png#lightbox)

Настройка представления по горизонтали стека со следующими параметрами:

[![](uistackview-images/quick04.png "Настройка параметров представления по горизонтали стека")](uistackview-images/quick04.png#lightbox)

Так как мы не хотим значок, представляющий каждый «точка» к оценке растяжение при его добавлении горизонтальное представление стека, мы сделали **выравнивание** для **Center** и  **Распределение** для **заполнения одинаково**.

Наконец, подключите следующие **торговцам** и **действия**:

[![](uistackview-images/quick05.png "Выходы представление стека и действия")](uistackview-images/quick05.png#lightbox)

### <a name="populate-a-uistackview-from-code"></a>Заполнение UIStackView из кода

Вернитесь в Visual Studio для Mac и изменить **ViewController.cs** файл и добавьте следующий код:

```csharp
public int Rating { get; set;} = 0;
...

partial void IncreaseRating (Foundation.NSObject sender) {

    // Maximum of 5 "stars"
    if (++Rating > 5 ) {
        // Abort
        Rating = 5;
        return;
    }

    // Create new rating icon and add it to stack
    var icon = new UIImageView (new UIImage("icon.png"));
    icon.ContentMode = UIViewContentMode.ScaleAspectFit;
    RatingView.AddArrangedSubview(icon);

    // Animate stack
    UIView.Animate(0.25, ()=>{
        // Adjust stack view
        RatingView.LayoutIfNeeded();
    });

}

partial void DecreaseRating (Foundation.NSObject sender) {

    // Minimum of zero "stars"
    if (--Rating < 0) {
        // Abort
        Rating =0;
        return;
    }

    // Get the last subview added
    var icon = RatingView.ArrangedSubviews[RatingView.ArrangedSubviews.Length-1];

    // Remove from stack and screen
    RatingView.RemoveArrangedSubview(icon);
    icon.RemoveFromSuperview();

    // Animate stack
    UIView.Animate(0.25, ()=>{
        // Adjust stack view
        RatingView.LayoutIfNeeded();
    });
}
```

Давайте подробно рассмотрим несколько фрагментов кода. Во-первых, мы используем `if` инструкции, чтобы проверить, что не более пяти «звезды» или меньше нуля.

Добавление нового «звезда» мы загрузить его изображение и задать его **режиме содержимого** для **размеру аспект шкалы**:

```csharp
var icon = new UIImageView (new UIImage("icon.png"));
icon.ContentMode = UIViewContentMode.ScaleAspectFit;
```

Это предотвращает значок «звезда» искажен при ее добавлении в представление стека.

Далее добавим новый значок «звезда» представление стека коллекцию представлений:

```csharp
RatingView.AddArrangedSubview(icon);
```

Вы заметите, что мы добавили `UIImageView` для `UIStackView` `ArrangedSubviews` свойство и не `SubView`. Любое представление, нужно добавить представление стека для управления его макет должен быть добавлен `ArrangedSubviews` свойство.

Сначала удалить вложенное представление из представления в виде стека, мы получаем вложенное представление для удаления:

```csharp
var icon = RatingView.ArrangedSubviews[RatingView.ArrangedSubviews.Length-1];
```

Затем необходимо удалить его из обоих `ArrangedSubviews` сбор и просмотр Super:

```csharp
// Remove from stack and screen
RatingView.RemoveArrangedSubview(icon);
icon.RemoveFromSuperview();
```

Удаление вложенное представление с только что `ArrangedSubviews` коллекции принимает его в систему управления представление стека, но не удалить с экрана.

### <a name="testing-the-ui"></a>Тестирование пользовательского интерфейса

Все необходимые элементы пользовательского интерфейса и кода в месте можно запустить и тестирования интерфейса. Когда отображается пользовательский Интерфейс, все элементы в представлении вертикальный стек будет размещаться через равные интервалы сверху вниз.

При нажатии кнопки **повысить рейтинг** кнопки на экран (не более 5) добавляется другой «звезда»:

[![](uistackview-images/intro01.png "Образец приложения будут работать")](uistackview-images/intro01.png#lightbox)

«Звезды» будет автоматически по центру и равномерное распределение в горизонтальное представление стека. Когда пользователь нажимает кнопку **Понизить рейтинг** кнопки «звезда» удаляется (пока не осталось none).

## <a name="stack-view-details"></a>Просмотр сведений о стеке

Теперь, когда у нас есть общее представление о том, что `UIStackView` элемент управления и как она работает, давайте более подробное рассмотрение некоторые его возможности и сведения.

### <a name="auto-layout-and-size-classes"></a>Автоматический макет и размер-классы

Как было показано выше, когда вложенное представление добавляется в представление стека в макете полностью управляются с помощью автоматический макет и размер классов позиция и размер представления, упорядоченные по представление стека.

Представление стека будет _ПИН-код_ вложенное представление первым и последним в коллекции для **верхней** и **нижней** границ для представлений вертикальный стек или **слева**и **право** границ для горизонтальной представлений стека. Если задать `LayoutMarginsRelativeArrangement` свойства `true`, то представление прикрепляет представлений для соответствующих полей вместо границе.

Вложенное представление использует представление стека `IntrinsicContentSize` свойство при вычислении размера представлений вдоль определенного `Axis` (за исключением `FillEqually Distribution`). `FillEqually Distribution` Размера всех представлений, чтобы они имеют один и тот же размер, тем самым заполнения представление стека вдоль `Axis`.

За исключением элемента `Fill Alignment`, представление стека использует вложенное представление `IntrinsicContentSize` свойства для вычисления размера представления перпендикулярно данного `Axis`. Для `Fill Alignment`, размер всех представлений, чтобы они полностью перпендикулярно представление стека данного `Axis`.

### <a name="positioning-and-sizing-the-stack-view"></a>Позиционирование и изменение размеров представление стека

Хотя представление стека имеет полный контроль над макетом любой вложенное представление (зависимости от свойств, таких как `Axis` и `Distribution`), все равно необходимо разместить представление стека (`UIStackView`) в рамках его родительского представления с помощью автоматический макет и размер классов.

Как правило это означает, по крайней мере два края представление стека, чтобы развернуть или свернуть, определяя таким образом его положение закрепления. Без любые дополнительные ограничения представление стека автоматически изменяться уместить все его представлений следующим образом:

 - Размер вдоль ее `Axis` будет представлять собой сумму размеров всех вложенное представление, а также все пространство, который был определен между каждой вложенное представление.
 - Если `LayoutMarginsRelativeArrangement` свойство `true`, размер стека представления также будет содержать место для поля.
 - Размер перпендикулярно `Axis` будет присвоено наибольшее вложенное представление в коллекции.

Кроме того, можно задать ограничения для представление стека **высота** и **ширина**. В этом случае представлений будет располагаться (размер) для заполнения всего пространства, определяется представление стека, что определяется `Distribution` и `Alignment` свойства.

Если `BaselineRelativeArrangement` свойство `true`, представлений будет располагаться в зависимости от базовой первой или последней вложенное представление элемента, вместо использования **верхней**, **нижней** или **Center* -  **Y** позиции. Они вычисляются на содержимое представления стека следующим образом:

 - Возвращает вертикальное представление стека первый вложенное представление для первого базового и последнего за последние. Если любой из этих представлений, сами представления стека, то будет использоваться первый или последний базовому плану.
 - Горизонтальное представление стека будет использовать его высотой вложенное представление для первой и последней базовой линии. Если высотой представление является также представление стека, он будет использоваться его высотой вложенное представление в качестве базового.

> [!IMPORTANT]
> **Примечание:** выравнивание по базовому плану работает на вложенное представление растяжением или сжатый размер базовых будут вычисляться в неправильной позиции. Выравнивание базового плана, убедитесь, что вложенное представление **высота** соответствует встроенный содержимого представления **высота**.

### <a name="common-stack-view-uses"></a>Распространенные варианты представление стека

Существует несколько типов макета, которые работают с элементами управления представление стека. В соответствии с Apple Вот несколько наиболее распространенных вариантов.

- **Определить размер вдоль оси** — путем закрепления обоих краев вдоль представление стека `Axis` и один из соседних краев, чтобы установить позицию стека, представление будет увеличиваться на оси в соответствии с интервалом, определяется его представлений.
 -  **Определить вложенное представление позиции** — путем закрепления смежные границам представление стека представление родительского представление стека будет увеличиваться в обоих измерений в соответствии с содержащего представлений.
- **Определить размер и положение стека** — путем закрепления всех четырех краев представление стека родительскому представлению, представление стека упорядочивает представлений, зависит от используемого пространства, определенные в представление стека.
 -  **Определить размер перпендикулярной осью** — путем закрепления обоих краев перпендикулярно представление стека `Axis` и одним границ вдоль оси, чтобы установить позицию стека, представление будет увеличиваться Перпендикулярные оси в соответствии с интервалом, определяется его представлений.

### <a name="managing-the-appearance"></a>Управление внешним видом

`UIStackView` Разработана как представление контейнера без отрисовки и таким образом, он не рисуется на холст, как и другие подклассы `UIView`. Установка свойств, таких как `BackgroundColor` или переопределение `DrawRect` не будет действовать visual.

Существует несколько свойств, определяющих, как представление стека организует свою коллекцию представлений:

- **Оси** — определяет, если представление стека упорядочивает представлений либо **по горизонтали** или **по вертикали**.
- **Выравнивание** — управляет выравниванием представлений в представление стека.
- **Распределение** — определяет способ изменения размеров представлений в представление стека.
- **Интервал между** — определяет минимальное расстояние между каждой вложенное представление в представление стека.
- **Относительно базовой линии** — Если `true`, вертикальный интервал каждого вложенное представление будет производным от базового плана ее.
- **Макет полей относительного** — помещает представлений относительно стандартного поля.

Обычно для размещения небольшое количество представлений используется представление стека. Более сложные пользовательские интерфейсы могут создаваться путем вложения одно или несколько представлений стека друг в друга (как это делалось [UIStackView краткое руководство](#UIStackView-Quickstart) выше).

Дальнейшей выполнить тонкую настройку внешнего вида пользовательских интерфейсов, добавив дополнительные ограничения для представлений (например, для управления высота или ширина). Однако следует соблюдать осторожность не должен включать конфликтующими ограничениями теми, представленный представление стека сам.

### <a name="maintaining-arranged-views-and-sub-views-consistency"></a>Поддержание упорядоченных представлений и согласованности представления Sub

Представление стека убедитесь, что его `ArrangedSubviews` свойства всегда является подмножеством его `Subviews` свойства, используя следующие правила:

 - Если добавляется вложенное представление `ArrangedSubviews` коллекции, он автоматически добавляется к `Subviews` коллекции (если он уже является частью этой коллекции).
 - Если вложенное представление удаляется из `Subviews` коллекция (удалить из изображения), также удаляется из `ArrangedSubviews` коллекции.
 - Удаление вложенное представление с `ArrangedSubviews` коллекции не удаляет его из `Subviews` коллекции. Поэтому он больше не располагаться представление стека, но по-прежнему отображаться на экране.

`ArrangedSubviews` Коллекция всегда является подмножеством `Subview` коллекции, однако порядок отдельных представлений каждой коллекции отдельный и управляется следующее:

 - Порядок представлений в `ArrangedSubviews` коллекции определите порядок их отображения в стеке.
 - Порядок представлений в `Subview` в представлении заднего плана к переднему определяет их Z-порядке (или слоев).

### <a name="dynamically-changing-content"></a>Динамическое изменение содержимого

Представление стека автоматически изменяется макет представлений всякий раз, когда вложенное представление добавлены, удалены или скрыты. Макет будет впоследствии также скорректирована если корректируется представление стека любого свойства (такие как его `Axis`).

Изменения макета могут быть анимированы, поместив их в блок анимации, например:

```csharp
// Animate stack
UIView.Animate(0.25, ()=>{
    // Adjust stack view
    RatingView.LayoutIfNeeded();
});
```

Многие свойства представление стека указываются с помощью классов размер в раскадровку. Эти свойства будут автоматически анимации — ответ на изменения размерами или ориентацией.

## <a name="summary"></a>Сводка

В этой статье был проиллюстрирован новый `UIStackView` управления (для iOS 9) для управления набором представлений, упорядоченные по горизонтали или вертикали стека приложения Xamarin.iOS.
Он начинается с простой пример использования представления стека для создания пользовательского интерфейса и завершит работу с более подробное рассмотрение стека и их свойства и функции.



## <a name="related-links"></a>Связанные ссылки

- [Образцы iOS 9](https://developer.xamarin.com/samples/ios/iOS9/)
- [iOS 9 для разработчиков](https://developer.apple.com/ios/pre-release/)
- [Новые возможности iOS 9.0](https://developer.apple.com/library/prerelease/ios/releasenotes/General/WhatsNewIniOS/Articles/iOS9.html)
- [Справочник по UIStackView](https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UIStackView_Class_Reference/)
- [Знакомство с приложением UIStackView (видео)](https://university.xamarin.com/lightninglectures/introducing-uistackview-on-ios9)
