---
title: Xamarin Profiler
description: В этом руководстве рассматриваются ключевые функции профилировщик Xamarin. Найдите на стандартного рабочего процесса, а на профилировщики, профилирования и при их использовании для профилирования приложения Xamarin.
ms.prod: xamarin
ms.assetid: 3247fcee-6acc-470d-ab87-c1c511d67363
author: topgenorth
ms.author: toopge
ms.date: 10/27/2017
ms.openlocfilehash: 7e28e2513b74faa884fb7bc3d7194f1b02844734
ms.sourcegitcommit: 0a72c7dea020b965378b6314f558bf5360dbd066
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/09/2018
---
# <a name="xamarin-profiler"></a>Xamarin Profiler

_В этом руководстве рассматриваются ключевые функции профилировщик Xamarin. Найдите на стандартного рабочего процесса, а на профилировщики, профилирования и при их использовании для профилирования приложения Xamarin._

Успех приложения зависит от конечного пользователя. Разработчик может реализован ряд действительно замечательных функций в приложении, но если приложение станет медленным или полного сбоя, пользователь скорее всего избавиться от него.

Исторически моно избранные мощные командной строки профилировщика для сбора сведений о программы, работающие в Mono среды выполнения называется [моно журнала профилировщика](http://www.mono-project.com/docs/debug+profile/profile/profiler/). Профилировщик Xamarin графический интерфейс для профилировщика моно журнала и поддерживает профилирование Android, iOS, tvOS и приложений для Mac на Mac и Android, iOS и tvOS приложений Windows.

Профилировщик Xamarin имеет ряд инструментов для профилирования — выделений, циклы и время профилировщика. В этом руководстве рассматриваются способы измерения эти инструменты и как они анализа приложения и разъясняется значение данных, представленных на каждом экране.

В этом руководстве рассматриваются стандартные сценарии профилирования и вводит профилировщика в качестве средства для анализа и оптимизации iOS и Android приложений.

## <a name="contents"></a>Описание

- [Загрузка и установка](#Download_and_Install)
- [Профилировщики и профилирование](#Profilers_and_Profiling)
- [Xamarin Profiler](#Xamarin_Profiler)
- [Поддержка профилировщика](#Profiler_Support)
- [Основы профилировщика](#Profiler_Basics)
    - [Позволяя профилирования в приложении](#Allowing_Profiling_in_your_App)
    - [Запуск профилировщика](#Launching_the_Profiler)
        - [Запуск из Visual Studio для Mac](#Launching_from_Xamarin_Studio)
        - [Запуск из Visual Studio](#Launching_from_Visual_Studio)
        - [Сохранение и загрузка профилировщика сеансов](#Saving_and_Loading_Profiler_Sessions)
        - [Профилировщик функций и инструментов](#Profiler_Features)
    - [Выделение](#Allocations)
    - [Профилировщик времени](#Time_Profiler)
    - [Циклы](#Cycles)
- [Профилирование приложений](#Profiling_Applications)
- [Сводка](#Summary)

## <a name="download-and-install"></a>Загрузка и установка

> [!NOTE]
> **Примечание:** необходимо быть [Visual Studio Enterprise](https://www.visualstudio.com/vs/compare/) подписчике, чтобы разблокировать этот компонент в любом Visual Studio Enterprise на Windows и Visual Studio для Mac на компьютерах Mac.

Профилировщик Xamarin — это автономное приложение и интегрируется с Visual Studio для Mac и Visual Studio для включения профилирования из в среде IDE.

### <a name="download"></a>Скачать

Загрузите пакет установки для вашей платформы:

- [**MacOS**](https://dl.xamarin.com/profiler/profiler-mac.pkg)
- [**Windows**](https://dl.xamarin.com/profiler/profiler-windows.msi)

После скачивания запустите установщик для добавления профилировщик Xamarin на компьютер.


## <a name="profilers-and-profiling"></a>Профилировщики и профилирование

Профилирование является шагом важные и часто уделяется недостаточно внимания при разработке приложения. Профилирование представляет собой форму **программы динамического анализа** -анализирует программы, пока выполняется и используется. Профилировщик — средство интеллектуального анализа данных, которое собирает сведения о времени сложность, использование некоторых методов и при выделении памяти. Профилировщик позволяет детализировать глубокие и анализировать эти показатели для выявления проблем в коде.

При проектировании и разработке приложения, очень важно не оптимизирует преждевременно; то есть тратить время, разработке кода в областях, которые редко будет осуществляться. Это power профилирования. Профилировщик обеспечивает представление о наиболее часто используемых частей базы кода и помогает найти областей, где следует уделить время внесения усовершенствований. Разработчикам следует позаботиться о понимать, где большую часть времени затрачивается в приложении и использование памяти приложением.

Профилирование полезна для всех типов приложений, но особенно важно в разработке мобильных приложений. Неоптимизированном коде гораздо более заметно на мобильных платформах, чем на настольных компьютерах и успех приложения зависит от привлекательных и оптимизированный код, который выполняется эффективно.

## <a name="xamarin-profiler"></a>Xamarin Profiler

Предоставляет разработчикам способ профилирования приложений из профилировщик Xamarin в Visual Studio для Mac или Visual Studio. Профилировщик собирает и отображает сведения о приложении, можно использовать разработчиком для анализа поведения приложения. Существует несколько разных способа профилирования приложения с профилировщиком Xamarin, а именно: профилирование памяти статистическая выборка. Они выполняются через выделения и время профилировщик инструментирует соответственно.

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

В настоящее время профилировщик Xamarin можно использовать для тестирования приложений Xamarin.iOS, Xamarin.Android и Xamarin.Mac на Mac (через Visual Studio для Mac). Профилировщик является отдельным процессом, в интегрированной среде разработки, и таким образом, в дополнение к запуске из Visual Studio для Mac, он может использоваться как автономное приложение для просмотра .exe и `.mlpd` файлов, которые были формируемые [профилировщик моно журнала](http://www.mono-project.com/docs/debug+profile/profile/profiler/).

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

В настоящее время Чтобы протестировать Xamarin.Android приложения в Windows (с помощью Visual Studio и Visual Studio для Mac) можно использовать профилировщик Xamarin. Профилировщик является отдельным процессом, в интегрированной среде разработки, и таким образом, в дополнение к запуске из Visual Studio, он может использоваться как автономное приложение для просмотра .exe и `.mlpd` файлов, которые были формируемые [профилировщик моно журнала](http://www.mono-project.com/docs/debug+profile/profile/profiler/) .

-----

<a name="Profiler_Support" />

## <a name="profiler-support"></a>Поддержка профилировщика

Поддержка профилировщик Xamarin доступен на следующих платформах:

 - Visual Studio для Mac (с корпоративной лицензией, macOS)
    - Android
        - Устройства и эмулятор
    - iOS
        - Устройства и симулятора
    - tvOS (инструмент времени не поддерживается)
        - Устройства и симулятора
    - Mac

 - Visual Studio (только **Enterprise** версии)
    - Android
        - Устройства и эмулятор
    - операций ввода-вывода [экспериментальный]
        - Устройства и симулятора
    - tvOS
        - Устройства и симулятора

Обратите внимание, что вы можете **только** профиль **отладки** конфигурации.

## <a name="profiler-basics"></a>Основы профилировщика

В этом разделе представлены части профилировщик Xamarin, а также обзор его функций.

### <a name="allow-profiling-in-your-app"></a>Разрешить профилирования в приложении

Прежде чем можно успешно профилирование приложения, необходимо разрешить профилирования в параметрах приложения проекта.

 - iOS:

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

  **Построение > iOS Отладка > включить профилирование**

  ![](images/ios-options-mac.png "операций ввода-вывода диалогового окна Параметры в Visual Studio для Mac")

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

  **Свойства > сборка iOS > включить профилирование**

  ![](images/ios-project-options-vs.png "диалоговое окно Параметры в Visual Studio iOS")

-----

 - Android:

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

  **Построение > Android Отладка > включить инструментария разработчика**

  ![Диалоговое окно Параметры Android в Visual Studio для Mac](images/android-project-options.png)

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

  **Построение > Android Отладка > включить инструментария разработчика**

  ![Диалоговое окно Параметры Android в Visual Studio для Mac](images/android-project-options-vs-sml.png)

-----

### <a name="launching-the-profiler"></a>Запуск профилировщика

Профилировщик Xamarin может быть запущено из интерфейс IDE при профилировании iOS или Android приложение или как автономное приложение.

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

#### <a name="launching-from-visual-studio-for-mac"></a>Запуск из Visual Studio для Mac

1. Во-первых убедитесь, пока приложение будет загружен в Visual Studio для Mac и Выбор конфигурации отладки (по умолчанию).
2. Перейдите к **запуска > запустить профилирование**в Visual Studio для Mac, или **анализ > профилировщик Xamarin** в Visual Studio, чтобы открыть профилировщика, как показано на следующем рисунке:

  ![](images/start-profiling-xs.png "Запуск профилировщика из Visual Studio для Mac")

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

#### <a name="launching-from-visual-studio"></a>Запуск из Visual Studio

1.  Во-первых убедитесь, что, пока приложение будет загружен в Visual Studio и выберите конфигурацию отладки (по умолчанию), как было описано выше.
2.  Перейдите к **анализ > профилировщик Xamarin** в Visual Studio, чтобы открыть профилировщика, как показано на следующем рисунке:

![Запуск профилировщика из Visual Studio](images/start-profiling-vs.png)

-----

Если элементы меню не отображаются, см. [руководство по устранению неполадок](~/tools/profiler/troubleshooting.md).

Это запускает профилировщик и автоматически начинает профилирование приложения.

Можно использовать профилировщик для измерения памяти и производительности. Это достигается посредством распределения и время профилировщик инструменты, которые рассматриваются в следующем разделе подробно.

#### <a name="saving-and-loading-profiler-sessions"></a>Сохранение и загрузка профилировщика сеансов

Чтобы сохранить сеанс профилирования в любое время, выберите **файл > Сохранить как...**  в строке меню профилировщика. Это сохраняет файл в _mlpd_ формате, формате специальной, высокой степенью сжатия для данных профилирования.

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

После установки профилировщик Xamarin можно найти в папке приложения, как показано на снимке экрана ниже:

![](images/applications.png "Открытие автономный профилировщик с Mac")

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

После установки приложения профилировщик Xamarin можно найти в каталоге приложения:

![](images/applications-vs.png "Открытие автономный профилировщик с Windows ")

-----

Можно загрузить *.mlpd* файлы профилировщика, открыв автономное приложение, выбрав **выберите целевой** и загрузке файла.

Дополнительные сведения см. в разделе [Создание файлов .mlpd ](~/tools/profiler/troubleshooting.md#gen_mlpd).


## <a name="profiler-features"></a>Функции профилировщика

Профилировщик Xamarin состоит из пяти разделов, как показано ниже:

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

[![](images/profiler-mac-sml.png "Профилировщик разделы в Visual Studio для Mac")](images/profiler-mac.png#lightbox) 

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

[![](images/profiler-vs.png "Профилировщик разделы в Visual Studio")](images/profiler-vs.png#lightbox)

-----

- **Панель инструментов** — расположена в верхней части профилировщика, это обеспечивает возможность запуска и остановки профилирования, выберите целевой процесс, просмотреть время выполнения приложения и выберите разбиение представления, составляющих приложение профилировщика.
- **Инструментирование список** — перечисляет все инструменты, загружен в течение сеанса профилирования.
- **Построения диаграммы** — эти диаграммы по горизонтали связаны с соответствующей инструментов в списке инструментирования. Ползунок (показаны под профилировщик времени) можно использовать для масштабирования.
- **Инструментирование область сведений** -содержит данные, отображаемых в выбранном представлении текущего документа. Мы рассмотрим эти представления, более подробно в разделе ниже.
- **Представление инспектора** — это содержит разделы, которые могут быть выбраны сегментированных элементом управления. В разделах зависят от выбранного инструмент и включает в себя: параметры конфигурации, статистику, сведения о трассировке стека и путь к корней.

### <a name="allocations"></a>Выделение

Инструмент выделения предоставляет подробные сведения об объектах в приложении, как они создаются и сборщиком мусора.

В верхней части профилировщика является диаграмму распределения, которая отображает объем памяти, выделенной с регулярными интервалами, во время профилирования. В настоящее время график распределения — общее число операций выделения, а не размеру кучи на данный момент времени. С точки зрения никогда не будет задействован, только когда-либо увеличится. Сюда входят объекты в стеке. В зависимости от версии среды выполнения, который используется диаграммы может отличаться, даже для одного приложения.

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

[![](images/allocations1.png "Инструмент выделения")](images/allocations1.png#lightbox) 

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

[![](images/allocations1-vs.png "Инструмент выделения")](images/allocations1-vs.png#lightbox)

-----

Существуют разных представлений данных в инструмент выделения, которые позволяют разработчикам анализа как свои приложения с помощью и освобождении памяти. Эти представления описаны ниже.

 -   **Выделение** — это список всех операций выделения и группирует их по имени класса. Это обеспечивает значительные обзор классов и методов используемых, как часто они используются и общую размер классы, используемые. Дважды щелкнув класс покажет выделенной памяти: 

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

  [![](images/allocations3.png "Вкладка «Выделение»")](images/allocations3.png#lightbox) 

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

  [![](images/allocations2-vs.png "Вкладка «Выделение»")](images/allocations2-vs.png#lightbox)

-----

Представление инспектора для выделения предоставляет параметры для фильтрации и группирования объектов, Статистика на выделенной памяти и top выделения, а также представления для трассировки стека и путь к корню.

 -   **Дереве вызовов** — это показывает дерево вызовов всех потоков в приложении, включая сведения о памяти, выделенной для каждого узла. При выборе элемента в списке будут отображаться все узлы того же уровня серого цвета. Можно развернуть дерево или дважды щелкните элемент, чтобы детализировать его. При отображении этого представления данных, в представлении инспектор параметров отображения можно использовать для изменения того, который его предоставляет. В настоящее время существует два варианта:
    1.  **Инвертированный дерево вызовов** — это считает, что трассировка стека сверху вниз. Это параметр удобный просмотра как указывается глубокой методы где ЦП тратит время его.
    2.  **Отдельный поток** — этот параметр организует дерево вызовов потоком.

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

  [![](images/allocations2.png "Вкладка «Дерево вызовов»")](images/allocations2.png#lightbox) 

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

  [![](images/allocations3-vs.png "Вкладка «Дерево вызовов»")](images/allocations3-vs.png#lightbox)

-----

 -   **Моментальные снимки** — в этой области отображаются сведения о моментальных снимках памяти. Для создания этих во время выполнения профилирования приложения в реальном времени, щелкните _камеры_ на панели инструментов в каждой точке, который вы хотите проверить сохраняется и освобождения памяти. Затем можно щелкнуть каждый моментальный снимок для изучения того, что происходит за кулисами. Обратите внимание, что моментальные снимки можно создавать только после ввода в эксплуатацию, профилирование приложения. 

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

  [![](images/allocations4.png "Вкладка моментальные снимки")](images/allocations4.png#lightbox) 

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

  [![](images/allocations4-vs.png "Вкладка моментальные снимки")](images/allocations4-vs.png#lightbox)

-----

### <a name="time-profiler"></a>Профилировщик времени

Инструмент времени профилировщик измеряет точно сколько время, затраченное на каждый метод приложения. Приложение приостановлено через регулярные интервалы и трассировку стека выполняется по каждому активному потоку. Каждая строка в область данных инструментирования отображает путь выполнения, соблюдается.

Диаграмму, как показано на снимке экрана ниже, отображает число выборок, полученные приложением во время его выполнения:

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

[![Время инструментирования профилировщика](images/time1.png)](images/time1.png#lightbox) 

[![Время инструментирования профилировщика — список образцов](images/time3.png)](images/time3.png#lightbox) 

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

[![Время инструментирования профилировщика](images/time1-vs.png)](images/time1-vs.png#lightbox) 

[![Время инструментирования профилировщика — список образцов](images/time3-vs.png)](images/time3-vs.png#lightbox) 

-----


- **Дереве вызовов** — показывает количество времени, затраченное на каждый из методов:

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

  [![](images/time2.png "Время инструментирования профилировщика — дерева вызовов")](images/time2.png#lightbox) 

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

  [![](images/time2-vs.png "Время инструментирования профилировщика — дерева вызовов")](images/time2-vs.png#lightbox) 

-----

### <a name="cycles"></a>Циклы

С помощью C# и F # управляемого кода он может быть довольно часто, а также к сожалению довольно легко создавать ссылки на объекты, которые никогда не будет удален. Это intrument позволяет выявить те объекты и отображения циклов, на которые ссылается приложение.

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

[![Инструментирование циклов](images/cycles-vs.png)](images/time1-vs.png#lightbox) 

-----

## <a name="profiling-applications"></a>Профилирование приложений

В настоящее время можно профилировать только конфигурации отладки по умолчанию.

Если вы выполняете профилирование приложения с любой другой конфигурации, появится следующее диалоговое окно сообщения:


# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

[![Профилирование диалогового окна об ошибке](images/image001.png)](images/image001.png#lightbox) 

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

[![](images/image1vs.png "Профилирование диалогового окна об ошибке")](images/image1vs.png#lightbox) 

-----


Выберите **обновление** для продолжения.

<!---
## Profiling Android Applications


Due to the recent inclusion of the profiling libraries into any new Android project template, you will find that when profiling any legacy applications you are greeted with the message dialog above.

You will need to enable this to make sure that the profiling libraries are included in your Android application, for debug builds. This should not be checked for release builds as it creates overhead.


## Profiling iOS Applications

### Profiling tvOS

## Profiling Mac Applications
-->

### <a name="sgen-garbage-collector-and-profiling"></a>Сборщик мусора SGen и профилирование

[SGen](http://www.mono-project.com/docs/advanced/garbage-collector/sgen/) сборщик мусора используется для всех платформ Xamarin.

SGen является производным сборкой Мусора, которая выделяет память для объектов из приложения в три куч — Nursery, основной кучи и пространство больших объектов. Это позволяет быстрее выполнения сборки мусора. SGen в данный момент сервер глобального Каталога по умолчанию для Xamarin.Android и единой Xamarin.iOS приложения.

Xamarin.iOS приложений, использующих классический API используется Боэм сборки Мусора — сборщику мусора консервативной, отличных от поколениям. Как консервативной, это менее вероятно освободить память, что может привести к неточным результатам при использовании профилировщика. По этой причине инструмент распределения не может использоваться с Боэм сборщик мусора.

Появится диалоговое окно сообщения, если ваше приложение использует Боэм GC, Xamarin не рекомендуется переключение существующего приложения iOS, использовать Боэм для SGen без тщательного исследования и тщательное тестирование. Xamarin также не рекомендуется переключение SGen для профилирования и последующее переключение обратно, как эти результаты не будет предоставлять точные показатели использования памяти.

Дополнительные сведения об управлении памятью, см. [памяти и рекомендации по производительности](~/cross-platform/deploy-test/memory-perf-best-practices.md) руководства.

## <a name="summary"></a>Сводка

В этом руководстве мы рассматривали профилировании — и как это выгодно для разработчика. Затем мы представили профилировщик Xamarin, предоставляя некоторые журнал и сведения в работе. Наконец мы toured функции профилировщик Xamarin и анализировать распределения и инструментов профилировщик времени.


## <a name="related-links"></a>Связанные ссылки

- [Рекомендации по памятью и производительностью](~/cross-platform/deploy-test/memory-perf-best-practices.md)
- [Заметки о выпуске](https://developer.xamarin.com/releases/profiler/preview/)
