---
title: Журнал отладки Android
ms.prod: xamarin
ms.assetid: 01A715FE-9E9D-9B85-8A59-6568D8A09CA5
ms.technology: xamarin-android
author: mgmclemore
ms.author: mamcle
ms.date: 04/04/2018
ms.openlocfilehash: e0e22fe35dc5042a7b3c895a250803e936611629
ms.sourcegitcommit: 66807f8927d472fbfd0ff8bc77cea9b37e7b9a4f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/05/2018
---
# <a name="android-debug-log"></a>Журнал отладки Android

Очень часто разработчики для отладки своих приложений используют вызовы к `Console.WriteLine`. Однако на мобильной платформе, такой как Android, консоль отсутствует. На устройствах Android доступен журнал, который можно использовать при создании приложений. Иногда его называют _logcat_ из-за команды, которую нужно ввести для его получения. Для просмотра данных журнала используйте инструмент **Журнал отладки**.

## <a name="android-debug-log-overview"></a>Общие сведения о журнале отладки Android

Инструмент **Журнал отладки** позволяет просматривать выходные данные журнала при отладке приложения с помощью Visual Studio. Журнал отладки поддерживает следующие устройства:

-   физические телефоны, планшеты и переносные устройства Android;
-   виртуальные устройства Android, работающие в эмуляторе Google Android. 

> [!NOTE]
> Инструмент **Журнал отладки** не работает с Xamarin Live Player.

**Журнал отладки** не отображает сообщения журнала, созданные во время автономной работы приложения на устройстве (т. е. пока устройство не подключено к Visual Studio).


## <a name="accessing-the-debug-log-from-visual-studio"></a>Получение доступа к журналу отладки из Visual Studio

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

Чтобы открыть инструмент **Журнал устройств**, щелкните значок **Журнал устройств (logcat)** на панели инструментов:

[![Расположение инструмента "Журнал устройств" на панели инструментов](android-debug-log-images/vswin-01-logcat-sml.png)](android-debug-log-images/vswin-01-logcat.png#lightbox)

Кроме того, можно запустить инструмент **Журнал устройств**, последовательно открыв такие элементы меню:

-   **Вид > Другие окна > Журнал устройств**
-   **Сервис -> Android -> Журнал устройств**

На следующем снимке экрана показаны разные элементы окна **Инструмент для отладки**:

[![Элементы окна "Инструмент для отладки"](android-debug-log-images/vswin-03-features-sml.png)](android-debug-log-images/vswin-03-features.png#lightbox)

-   **Селектор устройства** — выбор физического устройства или запущенного эмулятора для мониторинга.

-   **Записи журнала** — таблица сообщений журнала из журнала logcat.

-   **Очистка записей журнала** — очистка всех записей текущего журнала из таблицы.

-   **Воспроизведение/Пауза** — переключение между обновлением и приостановкой отображения новых записей журнала.

-   **Остановить** — остановка отображения новых записей журнала.

-   **Поле поиска** — ввод строк поиска в это поле позволяет выполнить фильтрацию по записям журнала.


Когда отображается окно инструмента **Журнал отладки**, используйте раскрывающееся меню устройства, чтобы выбрать устройство Android для мониторинга:

[![Расположение селектора устройства](android-debug-log-images/vswin-02-devices-combo-sml.png)](android-debug-log-images/vswin-02-devices-combo.png#lightbox)

После выбора устройства инструмент **Журнал устройств** автоматически добавляет записи журнала из работающего приложения. Эти записи отображаются в таблице записей журнала. При переключении между устройствами ведение журнала устройств останавливается и запускается. Обратите внимание, что проект Android следует загрузить до того, как любые устройства будут отображаться в селекторе устройства. Если устройство не отображается в селекторе устройства, убедитесь, что оно доступно в раскрывающемся меню Visual Studio на устройстве рядом с кнопкой **Пуск**.


# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

Чтобы открыть **журнал устройства**, последовательно выберите **Вид > Панели > Журнал устройств**:

[![Расположение пункта меню "Журнал устройств"](android-debug-log-images/vsmac-01-logcat-sml.png)](android-debug-log-images/vsmac-01-logcat.png#lightbox)

На следующем снимке экрана показаны разные элементы окна **Инструмент для отладки**:

[![Элементы окна "Инструмент для отладки"](android-debug-log-images/vsmac-03-features-sml.png)](android-debug-log-images/vsmac-03-features.png#lightbox)

-   **Селектор устройства** — выбор физического устройства или запущенного эмулятора для мониторинга.

-   **Записи журнала** — таблица сообщений журнала из журнала logcat.

-   **Очистка записей журнала** — очистка всех записей текущего журнала из таблицы.

-   **Поле поиска** — ввод строк поиска в это поле позволяет выполнить фильтрацию по записям журнала.

-   **Показать сообщения** — включает и отключает отображение информационных сообщений.

-   **Показать предупреждения** — включает и отключает отображение сообщений с предупреждениями (они выделяются желтым цветом).

-   **Показать ошибки** — включает и отключает отображение сообщений об ошибках (они выделяются красным цветом).

-   **Повторное подключение** — выполняет повторное подключение к устройству и обновление отображаемых записей журнала.

-   **Добавление маркера** — вставляет сообщения маркера (например, `--- Marker N ---`) после последней записи журнала, где _N_ — это счетчик, который начинается с 1 и увеличивается на 1 по мере добавления новых маркеров.

Когда отображается окно инструмента "Журнал отладки", используйте раскрывающееся меню устройства, чтобы выбрать устройство Android для мониторинга:

[![Расположение селектора устройства](android-debug-log-images/vsmac-02-devices-combo-sml.png)](android-debug-log-images/vsmac-02-devices-combo.png#lightbox)

После выбора устройства инструмент **Журнал устройств** автоматически добавляет записи журнала из работающего приложения. Эти записи отображаются в таблице записей журнала. При переключении между устройствами ведение журнала устройств останавливается и запускается. Обратите внимание, что проект Android следует загрузить до того, как любые устройства будут отображаться в селекторе устройства. Если устройство не отображается в селекторе устройства, убедитесь, что оно доступно в раскрывающемся меню Visual Studio на устройстве рядом с кнопкой **Пуск**.

-----


## <a name="accessing-from-the-command-line"></a>Доступ из командной строки

# <a name="visual-studiotabvswin"></a>[Visual Studio](#tab/vswin)

Кроме того, просмотреть журнал отладки можно с помощью командной строки. Откройте окно командной строки и перейдите в папку platform-tools пакета SDK для Android (как правило, эта папка хранится в расположении **C:\\Program Files (x86)\\Android\\android sdk\\platform-tools**).

Если подключено только одно устройство (физическое устройство или эмулятор), для просмотра журнала можно просто ввести следующую команду:

```shell
$ adb logcat
```

# <a name="visual-studio-for-mactabvsmac"></a>[Visual Studio для Mac](#tab/vsmac)

Кроме того, просмотреть журнал отладки можно с помощью командной строки. Откройте окно терминала и перейдите в папку platform-tools пакета SDK для Android (как правило, эта папка хранится в расположении **/Users/username/Library/Developer/Xamarin/android-sdk-macosx/platform-tools**).

Если подключено только одно устройство (физическое устройство или эмулятор), для просмотра журнала можно просто ввести следующую команду:

```shell
$ ./adb logcat
```

-----


Если подключено несколько устройств, необходимо явно указать нужное устройство. Например, при выполнении команды **adb -d logcat** отображается только журнал подключенного физического устройства, а при выполнении команды **adb -e logcat** — только журнал запущенного эмулятора.

Чтобы узнать дополнительные команды, введите **adb** и прочитайте сообщения справки.


## <a name="writing-to-the-debug-log"></a>Запись в журнал отладки

Записывать сообщения в **журнал отладки** можно с помощью методов класса [Android.Util.Log](https://developer.xamarin.com/api/type/Android.Util.Log/).
Пример: 

```csharp
string tag = "myapp";

Log.Info (tag, "this is an info message");
Log.Warn (tag, "this is a warning message");
Log.Error (tag, "this is an error message");
```

Вы увидите приблизительно следующее:

```shell
I/myapp   (11103): this is an info message
W/myapp   (11103): this is a warning message
E/myapp   (11103): this is an error message
```

Вы также можете использовать метод `Console.WriteLine` для записи в **журнал отладки** — в этом случае сообщения выводятся в logcat в немного другом формате (этот метод особенно полезен при отладке приложений Xamarin.Forms на Android):

```csharp
System.Console.WriteLine ("DEBUG - Button Clicked!");
```

Это выведет в logcat примерно следующее:

```
Info (19543) / mono-stdout: DEBUG - Button Clicked!
```

## <a name="interesting-messages"></a>Интересующие сообщения

При чтении журнала (особенно если фрагменты журнала предоставляются другим пользователям) изучаемое содержимое файла журнала в полном объеме часто является слишком громоздким.
Чтобы упростить навигацию по сообщениям журнала, для начала найдите запись журнала, которая выглядит следующим образом:

```shell
I/ActivityManager(12944): Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=GcTest.GcTest/gctest.Activity1 } from pid 24175
```

В частности, найдите строку, которая соответствует регулярному выражению, также содержащему имя пакета приложения:

```shell
^I.*ActivityManager.*Starting: Intent
```

Это строка, которая соответствует началу действия, и *большинство* (но не все) следующих сообщений должны иметь отношение к приложению.

Обратите внимание, что каждое сообщение содержит идентификатор процесса (pid) для процесса, создающего сообщение. В указанном выше сообщении `ActivityManager` сообщение было создано процессом `12944`. Чтобы определить, какой процесс является процессом отлаживаемого приложения, найдите сообщение **mono.MonoRuntimeProvider**: 

```shell
I/ActivityThread(  602): Pub TouchTest.TouchTest.__mono_init__: mono.MonoRuntimeProvider
```

Это сообщение отправляется запущенным процессом. Все последующие сообщения, содержащие этот pid, отправляются этим же процессом.
